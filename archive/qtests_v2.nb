(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    139955,       4066]
NotebookOptionsPosition[    136258,       3949]
NotebookOutlinePosition[    136599,       3964]
CellTagsIndexPosition[    136556,       3961]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"Derivative", "/:", 
   RowBox[{"MakeBoxes", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Derivative", "[", "\[Alpha]__", "]"}], "[", "f1_", "]"}], "[",
       "vars__Symbol", "]"}], ",", "TraditionalForm"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"bb", ",", "dd", ",", "sp"}], "}"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"MakeBoxes", "[", 
        RowBox[{"dd", ",", "_"}], "]"}], "^=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"{", "\[Alpha]", "}"}], "]"}], "\[Equal]", "1"}], ",", 
         "\"\<\[DifferentialD]\>\"", ",", "\"\<\[PartialD]\>\""}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"MakeBoxes", "[", 
        RowBox[{"sp", ",", "_"}], "]"}], "^=", "\"\<\[ThinSpace]\>\""}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"bb", "/:", 
       RowBox[{"MakeBoxes", "[", 
        RowBox[{
         RowBox[{"bb", "[", "x__", "]"}], ",", "_"}], "]"}], ":=", 
       RowBox[{"RowBox", "[", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ToBoxes", "[", "#", "]"}], "&"}], ",", 
          RowBox[{"{", "x", "}"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"FractionBox", "[", 
       RowBox[{
        RowBox[{"ToBoxes", "[", 
         RowBox[{"bb", "[", 
          RowBox[{
           RowBox[{"dd", "^", 
            RowBox[{"Plus", "[", "\[Alpha]", "]"}]}], ",", "f1"}], "]"}], 
         "]"}], ",", 
        RowBox[{"ToBoxes", "[", 
         RowBox[{"Apply", "[", 
          RowBox[{"bb", ",", 
           RowBox[{"Riffle", "[", 
            RowBox[{
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"bb", "[", 
                 RowBox[{"dd", ",", "#"}], "]"}], "&"}], ",", 
               RowBox[{"Select", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"{", "vars", "}"}], "^", 
                   RowBox[{"{", "\[Alpha]", "}"}]}], ")"}], ",", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"#", "=!=", "1"}], "&"}], ")"}]}], "]"}]}], "]"}], 
             ",", "sp"}], "]"}]}], "]"}], "]"}]}], "]"}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"einsum", "[", 
    RowBox[{
     RowBox[{"in_List", "\[Rule]", "out_"}], ",", "arrays__"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"res", "=", 
       RowBox[{"isum", "[", 
        RowBox[{
         RowBox[{"in", "\[Rule]", "out"}], ",", 
         RowBox[{"{", "arrays", "}"}]}], "]"}]}], "}"}], ",", 
     RowBox[{"res", "/;", 
      RowBox[{"res", "=!=", "$Failed"}]}]}], "]"}]}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"isum", "[", 
    RowBox[{
     RowBox[{"in_List", "\[Rule]", "out_"}], ",", "arrays_List"}], "]"}], ":=", 
   RowBox[{"Catch", "@", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "indices", ",", "contracted", ",", "uncontracted", ",", "contractions",
         ",", "transpose"}], "}"}], ",", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "in", "]"}], "\[NotEqual]", 
          RowBox[{"Length", "[", "arrays", "]"}]}], ",", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{"einsum", "::", "length"}], ",", 
            RowBox[{"Length", "[", "in", "]"}], ",", 
            RowBox[{"Length", "[", "arrays", "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Throw", "[", "$Failed", "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"IntegerQ", "@", 
              RowBox[{"TensorRank", "[", "#1", "]"}]}], "&&", 
             RowBox[{
              RowBox[{"Length", "[", "#1", "]"}], "\[NotEqual]", 
              RowBox[{"TensorRank", "[", "#2", "]"}]}]}], ",", 
            RowBox[{
             RowBox[{"Message", "[", 
              RowBox[{
               RowBox[{"einsum", "::", "shape"}], ",", "#1", ",", "#2"}], 
              "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"Throw", "[", "$Failed", "]"}]}]}], "]"}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"in", ",", "arrays"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"indices", "=", 
        RowBox[{"Tally", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{"in", ",", "1"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"DeleteCases", "[", 
           RowBox[{"indices", ",", 
            RowBox[{"{", 
             RowBox[{"_", ",", 
              RowBox[{"1", "|", "2"}]}], "}"}]}], "]"}], "=!=", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{"einsum", "::", "repeat"}], ",", 
            RowBox[{"Cases", "[", 
             RowBox[{"indices", ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x_", ",", 
                 RowBox[{"Except", "[", 
                  RowBox[{"1", "|", "2"}], "]"}]}], "}"}], "\[RuleDelayed]", 
               "x"}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Throw", "[", "$Failed", "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"uncontracted", "=", 
        RowBox[{"Cases", "[", 
         RowBox[{"indices", ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x_", ",", "1"}], "}"}], "\[RuleDelayed]", "x"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Sort", "[", "uncontracted", "]"}], "=!=", 
          RowBox[{"Sort", "[", "out", "]"}]}], ",", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{"einsum", "::", "output"}], ",", "uncontracted", ",", 
            "out"}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Throw", "[", "$Failed", "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"contracted", "=", 
        RowBox[{"Cases", "[", 
         RowBox[{"indices", ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x_", ",", "2"}], "}"}], "\[RuleDelayed]", "x"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"contractions", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"Position", "[", 
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{"in", ",", "1"}], "]"}], ",", "#"}], "]"}], "]"}], 
          "&"}], "/@", "contracted"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"transpose", "=", 
        RowBox[{"FindPermutation", "[", 
         RowBox[{"uncontracted", ",", "out"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Activate", "@", 
        RowBox[{"TensorTranspose", "[", 
         RowBox[{
          RowBox[{"TensorContract", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Inactive", "[", "TensorProduct", "]"}], "@@", 
             "arrays"}], ",", "contractions"}], "]"}], ",", "transpose"}], 
         "]"}]}]}]}], "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"qxq", "[", 
    RowBox[{"arg1_", ",", "arg0_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "q1", ",", "q0", ",", " ", "x0", ",", " ", "y0", ",", " ", "z0", ",", 
       " ", "w0", ",", " ", "x1", ",", " ", "y1", ",", " ", "z1", ",", " ", 
       "w1"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"q1", " ", "=", " ", "arg1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"q0", " ", "=", " ", "arg0"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x0", ",", "y0", ",", "z0", ",", "w0"}], "}"}], " ", "=", " ",
        "q0"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x1", ",", "y1", ",", "z1", ",", "w1"}], "}"}], " ", "=", " ",
        "q1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"x1", "*", "w0"}], "+", 
         RowBox[{"y1", "*", "z0"}], "-", 
         RowBox[{"z1", "*", "y0"}], "+", 
         RowBox[{"w1", "*", "x0"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "x1"}], "*", "z0"}], "+", 
         RowBox[{"y1", "*", "w0"}], "+", 
         RowBox[{"z1", "*", "x0"}], "+", 
         RowBox[{"w1", "*", "y0"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"x1", "*", "y0"}], "-", 
         RowBox[{"y1", "*", "x0"}], "+", 
         RowBox[{"z1", "*", "w0"}], "+", 
         RowBox[{"w1", "*", "z0"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "x1"}], "*", "x0"}], "-", 
         RowBox[{"y1", "*", "y0"}], "-", 
         RowBox[{"z1", "*", "z0"}], "+", 
         RowBox[{"w1", "*", "w0"}]}]}], "}"}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"qinv", "[", "x_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"q", ",", "qx", ",", "qy", ",", "qz", ",", "qw"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"q", "=", "x"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"qx", ",", "qy", ",", "qz", ",", "qw"}], "}"}], " ", "=", " ",
        "q"}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "qx"}], ",", 
        RowBox[{"-", "qy"}], ",", 
        RowBox[{"-", "qz"}], ",", "qw"}], "}"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"q2r", "[", "x_", "]"}], " ", ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"q", ",", "qw", ",", "qx", ",", "qy", ",", "qz"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"q", "=", "x"}], ";", "\[IndentingNewLine]", 
     RowBox[{"qx", " ", "=", " ", 
      RowBox[{"q", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"qy", " ", "=", " ", 
      RowBox[{"q", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"qz", " ", "=", " ", 
      RowBox[{"q", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"qw", " ", "=", " ", 
      RowBox[{"q", "[", 
       RowBox[{"[", "4", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1", "-", 
          RowBox[{"2", 
           SuperscriptBox["qy", "2"]}], "-", 
          RowBox[{"2", 
           SuperscriptBox["qz", "2"]}]}], ",", " ", 
         RowBox[{
          RowBox[{"2", "qx", " ", "qy"}], " ", "-", " ", 
          RowBox[{"2", " ", "qz", " ", "qw"}]}], ",", " ", 
         RowBox[{
          RowBox[{"2", " ", "qx", " ", "qz"}], " ", "+", " ", 
          RowBox[{"2", " ", "qy", " ", "qw"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"2", " ", "qx", " ", "qy"}], " ", "+", " ", 
          RowBox[{"2", " ", "qz", " ", "qw"}]}], ",", " ", 
         RowBox[{"1", " ", "-", " ", 
          RowBox[{"2", " ", 
           SuperscriptBox["qx", "2"]}], " ", "-", " ", 
          RowBox[{"2", " ", 
           SuperscriptBox["qz", "2"]}]}], ",", " ", 
         RowBox[{
          RowBox[{"2", " ", "qy", " ", "qz"}], " ", "-", " ", 
          RowBox[{"2", " ", "qx", " ", "qw"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"2", " ", "qx", " ", "qz"}], " ", "-", " ", 
          RowBox[{"2", " ", "qy", " ", "qw"}]}], ",", " ", 
         RowBox[{
          RowBox[{"2", " ", "qy", " ", "qz"}], " ", "+", " ", 
          RowBox[{"2", " ", "qx", " ", "qw"}]}], ",", " ", 
         RowBox[{"1", " ", "-", " ", 
          RowBox[{"2", " ", 
           SuperscriptBox["qx", "2"]}], "-", " ", 
          RowBox[{"2", " ", 
           SuperscriptBox["qy", "2"]}]}]}], "}"}]}], "}"}]}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.737632600976056*^9, 3.737632672903635*^9}, {
  3.737673891760989*^9, 3.737673894966807*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"qv2q", "[", "x_", "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "q", ",", " ", "qx", ",", " ", "qy", ",", " ", "qz", ",", " ", "qw"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"q", "=", "x"}], ";", "\[IndentingNewLine]", 
       RowBox[{"qx", " ", "=", " ", 
        RowBox[{"q", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"qy", " ", "=", " ", 
        RowBox[{"q", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"qz", " ", "=", " ", 
        RowBox[{"q", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"qw", " ", "=", " ", 
        RowBox[{"\[Sqrt]", 
         RowBox[{"(", 
          RowBox[{"1.0", " ", "-", " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["qx", "2"], "+", 
             SuperscriptBox["qy", "2"], "+", 
             SuperscriptBox["qz", "2"]}], ")"}]}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"qx", ",", "qy", ",", "qz", ",", "qw"}], "}"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"q2qv", "[", "x_", "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "q", ",", " ", "qx", ",", " ", "qy", ",", " ", "qz", ",", " ", "qw"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"q", "=", "x"}], ";", "\[IndentingNewLine]", 
       RowBox[{"qx", " ", "=", " ", 
        RowBox[{"q", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"qy", " ", "=", " ", 
        RowBox[{"q", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"qz", " ", "=", " ", 
        RowBox[{"q", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"qx", ",", "qy", ",", "qz"}], "}"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"q2lqv", "[", "x_", "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"q", ",", "qx", ",", "qy", ",", "qz", ",", "qw", ",", "n"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"q", "=", "x"}], ";", "\[IndentingNewLine]", 
       RowBox[{"qx", " ", "=", " ", 
        RowBox[{"q", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"qy", " ", "=", " ", 
        RowBox[{"q", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"qz", " ", "=", " ", 
        RowBox[{"q", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"qw", " ", "=", " ", 
        RowBox[{"q", "[", 
         RowBox[{"[", "4", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"n", " ", "=", " ", 
        RowBox[{"\[Sqrt]", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["qx", "2"], "+", 
           SuperscriptBox["qy", "2"], "+", 
           SuperscriptBox["qz", "2"]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"ArcCos", "[", "qw", "]"}], "/", "n"}], " ", "*", 
        RowBox[{"{", 
         RowBox[{"qx", ",", "qy", ",", "qz"}], "}"}]}]}]}], " ", 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"lqv2q", "[", "x_", "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "q", ",", "qx", ",", "qy", ",", "qz", ",", "qw", ",", " ", "ac", ",", 
        " ", "ra", ",", " ", "va"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"q", "=", "x"}], ";", "\[IndentingNewLine]", 
       RowBox[{"qx", " ", "=", " ", 
        RowBox[{"q", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"qy", " ", "=", " ", 
        RowBox[{"q", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"qz", " ", "=", " ", 
        RowBox[{"q", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ac", " ", "=", " ", 
        RowBox[{"\[Sqrt]", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["qx", "2"], "+", 
           SuperscriptBox["qy", "2"], "+", 
           SuperscriptBox["qz", "2"]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ra", " ", "=", " ", 
        RowBox[{"Cos", "[", "ac", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"va", " ", "=", " ", 
        RowBox[{
         RowBox[{"Sinc", "[", "ac", "]"}], " ", "*", " ", 
         RowBox[{"{", 
          RowBox[{"qx", ",", "qy", ",", "qz"}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"va", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"va", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", 
         RowBox[{"va", "[", 
          RowBox[{"[", "3", "]"}], "]"}], ",", "ra"}], "}"}]}]}], 
     "\[IndentingNewLine]", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.73763268635008*^9, 3.7376327290684853`*^9}, {
   3.737633013329266*^9, 3.737633014001874*^9}, {3.737677550011834*^9, 
   3.737677870156056*^9}, {3.737678533043638*^9, 3.737678537597365*^9}, 
   3.737689644540084*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"qi", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"qxi", ",", "qyi", ",", "qzi", ",", "qwi"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"qj", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"qxj", ",", "qyj", ",", "qzj", ",", "qwj"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"qij", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"qxij", ",", "qyij", ",", "qzij", ",", "qwij"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pi", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"pxi", ",", "pyi", ",", "pzi"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pj", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"pxj", ",", "pyj", ",", "pzj"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pij", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"pxij", ",", " ", "pyij", ",", " ", "pzij"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.737632745144824*^9, 3.7376327950842113`*^9}, {
  3.737674013899651*^9, 3.737674018443008*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"dpij", " ", "=", " ", 
   RowBox[{
    RowBox[{"q2r", "[", 
     RowBox[{"qinv", "[", "qij", "]"}], "]"}], ".", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"q2r", "[", 
        RowBox[{"qinv", "[", "qi", "]"}], "]"}], ".", 
       RowBox[{"(", 
        RowBox[{"pj", "-", "pi"}], ")"}]}], "-", "pij"}], ")"}]}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"q2lqv", "[", 
    RowBox[{"qxq", "[", 
     RowBox[{
      RowBox[{"qinv", "[", "qij", "]"}], ",", " ", 
      RowBox[{"qxq", "[", 
       RowBox[{
        RowBox[{"qinv", "[", "qi", "]"}], ",", "qj"}], "]"}]}], "]"}], "]"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"dqij", " ", "=", " ", 
  RowBox[{"q2qv", "[", 
   RowBox[{"qxq", "[", 
    RowBox[{
     RowBox[{"qinv", "[", "qij", "]"}], ",", " ", 
     RowBox[{"qxq", "[", 
      RowBox[{
       RowBox[{"qinv", "[", "qi", "]"}], ",", "qj"}], "]"}]}], "]"}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.737632802281664*^9, 3.737632933274053*^9}, {
  3.737633003129175*^9, 3.7376330240565577`*^9}, {3.737676865399136*^9, 
  3.737676865982445*^9}, {3.7376769941487017`*^9, 3.737676997724155*^9}, {
  3.73769161497119*^9, 3.73769161639358*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "pyij"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "pxi"}], "+", "pxj"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "qxi", " ", "qyi"}], "-", 
          RowBox[{"2", " ", "qwi", " ", "qzi"}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "pzi"}], "+", "pzj"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "qwi", " ", "qxi"}], "+", 
          RowBox[{"2", " ", "qyi", " ", "qzi"}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "pyi"}], "+", "pyj"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["qxi", "2"]}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["qzi", "2"]}]}], ")"}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "qxij", " ", "qyij"}], "+", 
       RowBox[{"2", " ", "qwij", " ", "qzij"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "pzij"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "pzi"}], "+", "pzj"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["qxi", "2"]}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["qyi", "2"]}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "pxi"}], "+", "pxj"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "qwi", " ", "qyi"}], "+", 
          RowBox[{"2", " ", "qxi", " ", "qzi"}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "pyi"}], "+", "pyj"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "qwi", " ", "qxi"}], "+", 
          RowBox[{"2", " ", "qyi", " ", "qzi"}]}], ")"}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", "qwij", " ", "qyij"}], "+", 
       RowBox[{"2", " ", "qxij", " ", "qzij"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "pxij"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "pyi"}], "+", "pyj"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "qxi", " ", "qyi"}], "+", 
          RowBox[{"2", " ", "qwi", " ", "qzi"}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "pzi"}], "+", "pzj"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "qwi", " ", "qyi"}], "+", 
          RowBox[{"2", " ", "qxi", " ", "qzi"}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "pxi"}], "+", "pxj"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["qyi", "2"]}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["qzi", "2"]}]}], ")"}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["qyij", "2"]}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["qzij", "2"]}]}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "pxij"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "pyi"}], "+", "pyj"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "qxi", " ", "qyi"}], "+", 
          RowBox[{"2", " ", "qwi", " ", "qzi"}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "pzi"}], "+", "pzj"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "qwi", " ", "qyi"}], "+", 
          RowBox[{"2", " ", "qxi", " ", "qzi"}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "pxi"}], "+", "pxj"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["qyi", "2"]}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["qzi", "2"]}]}], ")"}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "qxij", " ", "qyij"}], "-", 
       RowBox[{"2", " ", "qwij", " ", "qzij"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "pzij"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "pzi"}], "+", "pzj"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["qxi", "2"]}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["qyi", "2"]}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "pxi"}], "+", "pxj"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "qwi", " ", "qyi"}], "+", 
          RowBox[{"2", " ", "qxi", " ", "qzi"}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "pyi"}], "+", "pyj"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "qwi", " ", "qxi"}], "+", 
          RowBox[{"2", " ", "qyi", " ", "qzi"}]}], ")"}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "qwij", " ", "qxij"}], "+", 
       RowBox[{"2", " ", "qyij", " ", "qzij"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "pyij"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "pxi"}], "+", "pxj"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "qxi", " ", "qyi"}], "-", 
          RowBox[{"2", " ", "qwi", " ", "qzi"}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "pzi"}], "+", "pzj"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "qwi", " ", "qxi"}], "+", 
          RowBox[{"2", " ", "qyi", " ", "qzi"}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "pyi"}], "+", "pyj"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["qxi", "2"]}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["qzi", "2"]}]}], ")"}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["qxij", "2"]}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["qzij", "2"]}]}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["qxij", "2"]}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["qyij", "2"]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "pzij"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "pzi"}], "+", "pzj"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["qxi", "2"]}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["qyi", "2"]}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "pxi"}], "+", "pxj"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "qwi", " ", "qyi"}], "+", 
          RowBox[{"2", " ", "qxi", " ", "qzi"}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "pyi"}], "+", "pyj"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "qwi", " ", "qxi"}], "+", 
          RowBox[{"2", " ", "qyi", " ", "qzi"}]}], ")"}]}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "pxij"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "pyi"}], "+", "pyj"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "qxi", " ", "qyi"}], "+", 
          RowBox[{"2", " ", "qwi", " ", "qzi"}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "pzi"}], "+", "pzj"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "qwi", " ", "qyi"}], "+", 
          RowBox[{"2", " ", "qxi", " ", "qzi"}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "pxi"}], "+", "pxj"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["qyi", "2"]}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["qzi", "2"]}]}], ")"}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "qwij", " ", "qyij"}], "+", 
       RowBox[{"2", " ", "qxij", " ", "qzij"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "pyij"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "pxi"}], "+", "pxj"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "qxi", " ", "qyi"}], "-", 
          RowBox[{"2", " ", "qwi", " ", "qzi"}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "pzi"}], "+", "pzj"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "qwi", " ", "qxi"}], "+", 
          RowBox[{"2", " ", "qyi", " ", "qzi"}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "pyi"}], "+", "pyj"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["qxi", "2"]}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["qzi", "2"]}]}], ")"}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", "qwij", " ", "qxij"}], "+", 
       RowBox[{"2", " ", "qyij", " ", "qzij"}]}], ")"}]}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.7376329335875273`*^9, {3.737632997029801*^9, 3.737633024687994*^9}, 
   3.7376727772903433`*^9, 3.737673908679541*^9, 3.7376739527353983`*^9, 
   3.7376768689247837`*^9, 3.737676911998413*^9, 3.737676998136745*^9, 
   3.737688773145246*^9, 3.7377453155856047`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", "qyij"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"qxj", " ", "qyi"}], "-", 
       RowBox[{"qxi", " ", "qyj"}], "-", 
       RowBox[{"qwj", " ", "qzi"}], "+", 
       RowBox[{"qwi", " ", "qzj"}]}], ")"}]}], "+", 
    RowBox[{"qzij", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "qwj"}], " ", "qyi"}], "+", 
       RowBox[{"qwi", " ", "qyj"}], "-", 
       RowBox[{"qxj", " ", "qzi"}], "+", 
       RowBox[{"qxi", " ", "qzj"}]}], ")"}]}], "+", 
    RowBox[{"qwij", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "qwj"}], " ", "qxi"}], "+", 
       RowBox[{"qwi", " ", "qxj"}], "+", 
       RowBox[{"qyj", " ", "qzi"}], "-", 
       RowBox[{"qyi", " ", "qzj"}]}], ")"}]}], "-", 
    RowBox[{"qxij", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"qwi", " ", "qwj"}], "+", 
       RowBox[{"qxi", " ", "qxj"}], "+", 
       RowBox[{"qyi", " ", "qyj"}], "+", 
       RowBox[{"qzi", " ", "qzj"}]}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{"qxij", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"qxj", " ", "qyi"}], "-", 
       RowBox[{"qxi", " ", "qyj"}], "-", 
       RowBox[{"qwj", " ", "qzi"}], "+", 
       RowBox[{"qwi", " ", "qzj"}]}], ")"}]}], "+", 
    RowBox[{"qwij", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "qwj"}], " ", "qyi"}], "+", 
       RowBox[{"qwi", " ", "qyj"}], "-", 
       RowBox[{"qxj", " ", "qzi"}], "+", 
       RowBox[{"qxi", " ", "qzj"}]}], ")"}]}], "-", 
    RowBox[{"qzij", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "qwj"}], " ", "qxi"}], "+", 
       RowBox[{"qwi", " ", "qxj"}], "+", 
       RowBox[{"qyj", " ", "qzi"}], "-", 
       RowBox[{"qyi", " ", "qzj"}]}], ")"}]}], "-", 
    RowBox[{"qyij", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"qwi", " ", "qwj"}], "+", 
       RowBox[{"qxi", " ", "qxj"}], "+", 
       RowBox[{"qyi", " ", "qyj"}], "+", 
       RowBox[{"qzi", " ", "qzj"}]}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{"qwij", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"qxj", " ", "qyi"}], "-", 
       RowBox[{"qxi", " ", "qyj"}], "-", 
       RowBox[{"qwj", " ", "qzi"}], "+", 
       RowBox[{"qwi", " ", "qzj"}]}], ")"}]}], "-", 
    RowBox[{"qxij", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "qwj"}], " ", "qyi"}], "+", 
       RowBox[{"qwi", " ", "qyj"}], "-", 
       RowBox[{"qxj", " ", "qzi"}], "+", 
       RowBox[{"qxi", " ", "qzj"}]}], ")"}]}], "+", 
    RowBox[{"qyij", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "qwj"}], " ", "qxi"}], "+", 
       RowBox[{"qwi", " ", "qxj"}], "+", 
       RowBox[{"qyj", " ", "qzi"}], "-", 
       RowBox[{"qyi", " ", "qzj"}]}], ")"}]}], "-", 
    RowBox[{"qzij", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"qwi", " ", "qwj"}], "+", 
       RowBox[{"qxi", " ", "qxj"}], "+", 
       RowBox[{"qyi", " ", "qyj"}], "+", 
       RowBox[{"qzi", " ", "qzj"}]}], ")"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7376329335875273`*^9, {3.737632997029801*^9, 3.737633024687994*^9}, 
   3.7376727772903433`*^9, 3.737673908679541*^9, 3.7376739527353983`*^9, 
   3.7376768689247837`*^9, 3.737676911998413*^9, 3.737676998136745*^9, 
   3.737688773145246*^9, 3.737745315607019*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "A", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"A00", " ", "=", " ", 
     RowBox[{"D", "[", 
      RowBox[{"dpij", ",", " ", 
       RowBox[{"{", "pi", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"A01", " ", "=", " ", 
     RowBox[{"D", "[", 
      RowBox[{"dpij", ",", " ", 
       RowBox[{"{", "qi", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"A10", " ", "=", " ", 
     RowBox[{"D", "[", 
      RowBox[{"dqij", ",", " ", 
       RowBox[{"{", "pi", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"A11", " ", "=", " ", 
    RowBox[{"D", "[", 
     RowBox[{"dqij", ",", " ", 
      RowBox[{"{", "qi", "}"}]}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"A", " ", "=", " ", 
     RowBox[{"ArrayFlatten", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"A00", ",", "A01"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"A10", ",", "A11"}], "}"}]}], "}"}], "]"}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"//", "MatrixForm"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Dimensions", "[", "A", "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FortranForm", "[", 
     RowBox[{"A", "//.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"1.", " ", "y_"}], "\[Rule]", "y"}], ",", 
        RowBox[{
         RowBox[{"E", "^", "x_"}], "\[Rule]", 
         RowBox[{"exp", "[", "x", "]"}]}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"B00", " ", "=", " ", 
     RowBox[{"D", "[", 
      RowBox[{"dpij", ",", " ", 
       RowBox[{"{", "pj", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"B01", " ", "=", " ", 
     RowBox[{"D", "[", 
      RowBox[{"dpij", ",", " ", 
       RowBox[{"{", "qj", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"B10", " ", "=", " ", 
     RowBox[{"D", "[", 
      RowBox[{"dqij", ",", " ", 
       RowBox[{"{", "pj", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"B11", " ", "=", " ", 
     RowBox[{"D", "[", 
      RowBox[{"dqij", ",", " ", 
       RowBox[{"{", "qj", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"B", " ", "=", " ", 
     RowBox[{"ArrayFlatten", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"B00", ",", "B01"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"B10", ",", "B11"}], "}"}]}], "}"}], "]"}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"//", "MatrixForm"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FortranForm", "[", 
     RowBox[{"B", "//.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"1.", " ", "y_"}], "\[Rule]", "y"}], ",", 
        RowBox[{
         RowBox[{"E", "^", "x_"}], "\[Rule]", 
         RowBox[{"exp", "[", "x", "]"}]}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.737632985973003*^9, 3.737632993816803*^9}, {
   3.737633041688315*^9, 3.73763313973496*^9}, {3.737633254654132*^9, 
   3.73763327290849*^9}, {3.737633488308668*^9, 3.737633520778075*^9}, {
   3.737634313273382*^9, 3.73763434484459*^9}, {3.737673981549273*^9, 
   3.737673982547817*^9}, {3.73767698691835*^9, 3.737676989232779*^9}, 
   3.7376890354371433`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", "qwij"}], " ", "qwj"}], "-", 
      RowBox[{"qxij", " ", "qxj"}], "+", 
      RowBox[{"qyij", " ", "qyj"}], "+", 
      RowBox[{"qzij", " ", "qzj"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "qxj"}], " ", "qyij"}], "-", 
      RowBox[{"qxij", " ", "qyj"}], "-", 
      RowBox[{"qwj", " ", "qzij"}], "-", 
      RowBox[{"qwij", " ", "qzj"}]}], ",", 
     RowBox[{
      RowBox[{"qwj", " ", "qyij"}], "+", 
      RowBox[{"qwij", " ", "qyj"}], "-", 
      RowBox[{"qxj", " ", "qzij"}], "-", 
      RowBox[{"qxij", " ", "qzj"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "qwj"}], " ", "qxij"}], "+", 
      RowBox[{"qwij", " ", "qxj"}], "+", 
      RowBox[{"qyj", " ", "qzij"}], "-", 
      RowBox[{"qyij", " ", "qzj"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", "qxj"}], " ", "qyij"}], "-", 
      RowBox[{"qxij", " ", "qyj"}], "+", 
      RowBox[{"qwj", " ", "qzij"}], "+", 
      RowBox[{"qwij", " ", "qzj"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "qwij"}], " ", "qwj"}], "+", 
      RowBox[{"qxij", " ", "qxj"}], "-", 
      RowBox[{"qyij", " ", "qyj"}], "+", 
      RowBox[{"qzij", " ", "qzj"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "qwj"}], " ", "qxij"}], "-", 
      RowBox[{"qwij", " ", "qxj"}], "-", 
      RowBox[{"qyj", " ", "qzij"}], "-", 
      RowBox[{"qyij", " ", "qzj"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "qwj"}], " ", "qyij"}], "+", 
      RowBox[{"qwij", " ", "qyj"}], "-", 
      RowBox[{"qxj", " ", "qzij"}], "+", 
      RowBox[{"qxij", " ", "qzj"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", "qwj"}], " ", "qyij"}], "-", 
      RowBox[{"qwij", " ", "qyj"}], "-", 
      RowBox[{"qxj", " ", "qzij"}], "-", 
      RowBox[{"qxij", " ", "qzj"}]}], ",", 
     RowBox[{
      RowBox[{"qwj", " ", "qxij"}], "+", 
      RowBox[{"qwij", " ", "qxj"}], "-", 
      RowBox[{"qyj", " ", "qzij"}], "-", 
      RowBox[{"qyij", " ", "qzj"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "qwij"}], " ", "qwj"}], "+", 
      RowBox[{"qxij", " ", "qxj"}], "+", 
      RowBox[{"qyij", " ", "qyj"}], "-", 
      RowBox[{"qzij", " ", "qzj"}]}], ",", 
     RowBox[{
      RowBox[{"qxj", " ", "qyij"}], "-", 
      RowBox[{"qxij", " ", "qyj"}], "-", 
      RowBox[{"qwj", " ", "qzij"}], "+", 
      RowBox[{"qwij", " ", "qzj"}]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.737672777309311*^9, 3.7376739206030607`*^9, 3.737673952751747*^9, 
   3.737673983419155*^9, 3.737676913000079*^9, {3.737676989480453*^9, 
   3.7376769996615868`*^9}, 3.737688773177683*^9, 3.7376890358593807`*^9, 
   3.737745315617828*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"6", ",", "7"}], "}"}]], "Output",
 CellChangeTimes->{
  3.737672777309311*^9, 3.7376739206030607`*^9, 3.737673952751747*^9, 
   3.737673983419155*^9, 3.737676913000079*^9, {3.737676989480453*^9, 
   3.7376769996615868`*^9}, 3.737688773177683*^9, 3.7376890358593807`*^9, 
   3.7377453156189003`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"dqvi", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"dqxi", ",", " ", "dqyi", ",", " ", "dqzi"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"qxq", "[", 
     RowBox[{
      RowBox[{"qv2q", "[", "dqvi", "]"}], ",", " ", "qi"}], "]"}], ",", " ", 
    RowBox[{"{", "dqvi", "}"}]}], "]"}], " ", "/.", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"dqxi", "\[Rule]", "0.0"}], ",", 
    RowBox[{"dqyi", "\[Rule]", "0.0"}], ",", 
    RowBox[{"dqzi", "\[Rule]", "0.0"}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", "%", "]"}]}], "Input",
 CellChangeTimes->{{3.737672959752376*^9, 3.7376730424029293`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0.`", "\[VeryThinSpace]", "+", "qwi"}], ",", 
     RowBox[{"0.`", "\[VeryThinSpace]", "+", "qzi"}], ",", 
     RowBox[{"0.`", "\[VeryThinSpace]", "-", "qyi"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0.`", "\[VeryThinSpace]", "-", "qzi"}], ",", 
     RowBox[{"0.`", "\[VeryThinSpace]", "+", "qwi"}], ",", 
     RowBox[{"0.`", "\[VeryThinSpace]", "+", "qxi"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0.`", "\[VeryThinSpace]", "+", "qyi"}], ",", 
     RowBox[{"0.`", "\[VeryThinSpace]", "-", "qxi"}], ",", 
     RowBox[{"0.`", "\[VeryThinSpace]", "+", "qwi"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0.`", "\[VeryThinSpace]", "-", "qxi"}], ",", 
     RowBox[{"0.`", "\[VeryThinSpace]", "-", "qyi"}], ",", 
     RowBox[{"0.`", "\[VeryThinSpace]", "-", "qzi"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.737673011420314*^9, 3.7376730426077223`*^9}, 
   3.737673952760428*^9, 3.737688773186874*^9, 3.737745315628448*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0.`", "\[VeryThinSpace]", "+", "qwi"}], ",", 
     RowBox[{"0.`", "\[VeryThinSpace]", "+", "qzi"}], ",", 
     RowBox[{"0.`", "\[VeryThinSpace]", "-", "qyi"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0.`", "\[VeryThinSpace]", "-", "qzi"}], ",", 
     RowBox[{"0.`", "\[VeryThinSpace]", "+", "qwi"}], ",", 
     RowBox[{"0.`", "\[VeryThinSpace]", "+", "qxi"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0.`", "\[VeryThinSpace]", "+", "qyi"}], ",", 
     RowBox[{"0.`", "\[VeryThinSpace]", "-", "qxi"}], ",", 
     RowBox[{"0.`", "\[VeryThinSpace]", "+", "qwi"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0.`", "\[VeryThinSpace]", "-", "qxi"}], ",", 
     RowBox[{"0.`", "\[VeryThinSpace]", "-", "qyi"}], ",", 
     RowBox[{"0.`", "\[VeryThinSpace]", "-", "qzi"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.737673011420314*^9, 3.7376730426077223`*^9}, 
   3.737673952760428*^9, 3.737688773186874*^9, 3.737745315630804*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"qerr", " ", "=", " ", 
  RowBox[{"q2lqv", "[", 
   RowBox[{"qxq", "[", 
    RowBox[{
     RowBox[{"qinv", "[", "qij", "]"}], ",", " ", 
     RowBox[{"qxq", "[", 
      RowBox[{
       RowBox[{"qinv", "[", "qi", "]"}], ",", "qj"}], "]"}]}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"evalex", " ", "=", " ", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pxi", "\[Rule]", "0.869720"}], ",", "\[IndentingNewLine]", 
    RowBox[{"pyi", "\[Rule]", "0.36348073"}], ",", "\[IndentingNewLine]", 
    RowBox[{"pzi", "\[Rule]", 
     RowBox[{"-", "0.63030591"}]}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"pxj", "\[Rule]", "0.84388098"}], ",", "\[IndentingNewLine]", 
    RowBox[{"pyj", "\[Rule]", "0.84732604"}], ",", "\[IndentingNewLine]", 
    RowBox[{"pzj", "\[Rule]", 
     RowBox[{"-", "0.25890034"}]}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"pxij", "\[Rule]", " ", "0.25774847"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"pyij", "\[Rule]", " ", "0.06106425"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"pzij", " ", "\[Rule]", " ", "0.60603896"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"qxi", "\[Rule]", " ", 
     RowBox[{"-", "0.25738353"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"qyi", " ", "\[Rule]", " ", 
     RowBox[{"-", "0.0535528"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"qzi", " ", "\[Rule]", " ", "0.95436285"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"qwi", " ", "\[Rule]", " ", "0.14169462"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"qxj", " ", "\[Rule]", " ", 
     RowBox[{"-", "0.28314605"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"qyj", " ", "\[Rule]", " ", 
     RowBox[{"-", "0.55447087"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"qzj", " ", "\[Rule]", " ", 
     RowBox[{"-", "0.49128177"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"qwj", " ", "\[Rule]", " ", "0.60912445"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"qxij", " ", "\[Rule]", " ", 
     RowBox[{"-", "0.45908567"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"qyij", " ", "\[Rule]", " ", "0.37739565"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"qzij", " ", "\[Rule]", " ", 
     RowBox[{"-", "0.76267314"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"qwij", " ", "\[Rule]", " ", 
     RowBox[{"-", "0.25523039"}]}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"qerr", " ", "/.", "evalex"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"D", "[", 
   RowBox[{"qerr", ",", " ", 
    RowBox[{"{", "qi", "}"}]}], "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"FortranForm", "[", 
    RowBox[{"%", "//.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"1.", " ", "y_"}], "\[Rule]", "y"}], ",", 
       RowBox[{
        RowBox[{"E", "^", "x_"}], "\[Rule]", 
        RowBox[{"exp", "[", "x", "]"}]}]}], "}"}]}], "]"}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"q2qv", "[", "qerr", "]"}], ",", " ", 
      RowBox[{"{", "qj", "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"FortranForm", "[", 
     RowBox[{"%", "//.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"1.", " ", "y_"}], "\[Rule]", "y"}], ",", 
        RowBox[{
         RowBox[{"E", "^", "x_"}], "\[Rule]", 
         RowBox[{"exp", "[", "x", "]"}]}]}], "}"}]}], "]"}]}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"Simplify", "[", "qerr", "]"}], ",", " ", 
      RowBox[{"{", "qi", "}"}]}], "]"}], "\[IndentingNewLine]", 
    RowBox[{"Dimensions", "[", "%", "]"}], "\[IndentingNewLine]", 
    RowBox[{"D", "[", 
     RowBox[{"qerr", ",", " ", 
      RowBox[{"{", "qj", "}"}]}], "]"}]}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.737677252153199*^9, 3.73767728006752*^9}, {
   3.737677311222941*^9, 3.737677339638145*^9}, {3.73767749099478*^9, 
   3.7376774926437073`*^9}, {3.737677529587883*^9, 3.7376775328277063`*^9}, {
   3.73767788108657*^9, 3.737677909333425*^9}, 3.73767808071616*^9, {
   3.7376781252684183`*^9, 3.737678125501689*^9}, {3.7376887981926937`*^9, 
   3.737688881494834*^9}, 3.737689041860952*^9, {3.7376900370777187`*^9, 
   3.7376900374424973`*^9}, {3.7376902347696037`*^9, 
   3.7376904673617363`*^9}, {3.737690514245634*^9, 3.737690542333084*^9}, {
   3.737690581470813*^9, 3.737690685034861*^9}, {3.737690730868557*^9, 
   3.737690741581049*^9}, {3.737690857889731*^9, 3.7376908946821547`*^9}, {
   3.7376909653610697`*^9, 3.737690974782537*^9}, {3.737691025191792*^9, 
   3.737691059052558*^9}, {3.737691543624447*^9, 3.7376915774925013`*^9}, {
   3.737691648695784*^9, 3.7376916489308167`*^9}, {3.737692379087639*^9, 
   3.737692381634973*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "qyij"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"qxj", " ", "qyi"}], "-", 
           RowBox[{"qxi", " ", "qyj"}], "-", 
           RowBox[{"qwj", " ", "qzi"}], "+", 
           RowBox[{"qwi", " ", "qzj"}]}], ")"}]}], "+", 
        RowBox[{"qzij", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "qwj"}], " ", "qyi"}], "+", 
           RowBox[{"qwi", " ", "qyj"}], "-", 
           RowBox[{"qxj", " ", "qzi"}], "+", 
           RowBox[{"qxi", " ", "qzj"}]}], ")"}]}], "+", 
        RowBox[{"qwij", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "qwj"}], " ", "qxi"}], "+", 
           RowBox[{"qwi", " ", "qxj"}], "+", 
           RowBox[{"qyj", " ", "qzi"}], "-", 
           RowBox[{"qyi", " ", "qzj"}]}], ")"}]}], "-", 
        RowBox[{"qxij", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"qwi", " ", "qwj"}], "+", 
           RowBox[{"qxi", " ", "qxj"}], "+", 
           RowBox[{"qyi", " ", "qyj"}], "+", 
           RowBox[{"qzi", " ", "qzj"}]}], ")"}]}]}], ")"}], " ", 
      RowBox[{"ArcCos", "[", 
       RowBox[{
        RowBox[{"qzij", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"qxj", " ", "qyi"}], "-", 
           RowBox[{"qxi", " ", "qyj"}], "-", 
           RowBox[{"qwj", " ", "qzi"}], "+", 
           RowBox[{"qwi", " ", "qzj"}]}], ")"}]}], "+", 
        RowBox[{"qyij", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "qwj"}], " ", "qyi"}], "+", 
           RowBox[{"qwi", " ", "qyj"}], "-", 
           RowBox[{"qxj", " ", "qzi"}], "+", 
           RowBox[{"qxi", " ", "qzj"}]}], ")"}]}], "+", 
        RowBox[{"qxij", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "qwj"}], " ", "qxi"}], "+", 
           RowBox[{"qwi", " ", "qxj"}], "+", 
           RowBox[{"qyj", " ", "qzi"}], "-", 
           RowBox[{"qyi", " ", "qzj"}]}], ")"}]}], "+", 
        RowBox[{"qwij", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"qwi", " ", "qwj"}], "+", 
           RowBox[{"qxi", " ", "qxj"}], "+", 
           RowBox[{"qyi", " ", "qyj"}], "+", 
           RowBox[{"qzi", " ", "qzj"}]}], ")"}]}]}], "]"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"\[Sqrt]", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "qyij"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"qxj", " ", "qyi"}], "-", 
              RowBox[{"qxi", " ", "qyj"}], "-", 
              RowBox[{"qwj", " ", "qzi"}], "+", 
              RowBox[{"qwi", " ", "qzj"}]}], ")"}]}], "+", 
           RowBox[{"qzij", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "qwj"}], " ", "qyi"}], "+", 
              RowBox[{"qwi", " ", "qyj"}], "-", 
              RowBox[{"qxj", " ", "qzi"}], "+", 
              RowBox[{"qxi", " ", "qzj"}]}], ")"}]}], "+", 
           RowBox[{"qwij", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "qwj"}], " ", "qxi"}], "+", 
              RowBox[{"qwi", " ", "qxj"}], "+", 
              RowBox[{"qyj", " ", "qzi"}], "-", 
              RowBox[{"qyi", " ", "qzj"}]}], ")"}]}], "-", 
           RowBox[{"qxij", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"qwi", " ", "qwj"}], "+", 
              RowBox[{"qxi", " ", "qxj"}], "+", 
              RowBox[{"qyi", " ", "qyj"}], "+", 
              RowBox[{"qzi", " ", "qzj"}]}], ")"}]}]}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"qxij", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"qxj", " ", "qyi"}], "-", 
              RowBox[{"qxi", " ", "qyj"}], "-", 
              RowBox[{"qwj", " ", "qzi"}], "+", 
              RowBox[{"qwi", " ", "qzj"}]}], ")"}]}], "+", 
           RowBox[{"qwij", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "qwj"}], " ", "qyi"}], "+", 
              RowBox[{"qwi", " ", "qyj"}], "-", 
              RowBox[{"qxj", " ", "qzi"}], "+", 
              RowBox[{"qxi", " ", "qzj"}]}], ")"}]}], "-", 
           RowBox[{"qzij", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "qwj"}], " ", "qxi"}], "+", 
              RowBox[{"qwi", " ", "qxj"}], "+", 
              RowBox[{"qyj", " ", "qzi"}], "-", 
              RowBox[{"qyi", " ", "qzj"}]}], ")"}]}], "-", 
           RowBox[{"qyij", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"qwi", " ", "qwj"}], "+", 
              RowBox[{"qxi", " ", "qxj"}], "+", 
              RowBox[{"qyi", " ", "qyj"}], "+", 
              RowBox[{"qzi", " ", "qzj"}]}], ")"}]}]}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"qwij", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"qxj", " ", "qyi"}], "-", 
              RowBox[{"qxi", " ", "qyj"}], "-", 
              RowBox[{"qwj", " ", "qzi"}], "+", 
              RowBox[{"qwi", " ", "qzj"}]}], ")"}]}], "-", 
           RowBox[{"qxij", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "qwj"}], " ", "qyi"}], "+", 
              RowBox[{"qwi", " ", "qyj"}], "-", 
              RowBox[{"qxj", " ", "qzi"}], "+", 
              RowBox[{"qxi", " ", "qzj"}]}], ")"}]}], "+", 
           RowBox[{"qyij", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "qwj"}], " ", "qxi"}], "+", 
              RowBox[{"qwi", " ", "qxj"}], "+", 
              RowBox[{"qyj", " ", "qzi"}], "-", 
              RowBox[{"qyi", " ", "qzj"}]}], ")"}]}], "-", 
           RowBox[{"qzij", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"qwi", " ", "qwj"}], "+", 
              RowBox[{"qxi", " ", "qxj"}], "+", 
              RowBox[{"qyi", " ", "qyj"}], "+", 
              RowBox[{"qzi", " ", "qzj"}]}], ")"}]}]}], ")"}], "2"]}], 
       ")"}]}], ")"}]}], ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"qxij", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"qxj", " ", "qyi"}], "-", 
           RowBox[{"qxi", " ", "qyj"}], "-", 
           RowBox[{"qwj", " ", "qzi"}], "+", 
           RowBox[{"qwi", " ", "qzj"}]}], ")"}]}], "+", 
        RowBox[{"qwij", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "qwj"}], " ", "qyi"}], "+", 
           RowBox[{"qwi", " ", "qyj"}], "-", 
           RowBox[{"qxj", " ", "qzi"}], "+", 
           RowBox[{"qxi", " ", "qzj"}]}], ")"}]}], "-", 
        RowBox[{"qzij", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "qwj"}], " ", "qxi"}], "+", 
           RowBox[{"qwi", " ", "qxj"}], "+", 
           RowBox[{"qyj", " ", "qzi"}], "-", 
           RowBox[{"qyi", " ", "qzj"}]}], ")"}]}], "-", 
        RowBox[{"qyij", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"qwi", " ", "qwj"}], "+", 
           RowBox[{"qxi", " ", "qxj"}], "+", 
           RowBox[{"qyi", " ", "qyj"}], "+", 
           RowBox[{"qzi", " ", "qzj"}]}], ")"}]}]}], ")"}], " ", 
      RowBox[{"ArcCos", "[", 
       RowBox[{
        RowBox[{"qzij", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"qxj", " ", "qyi"}], "-", 
           RowBox[{"qxi", " ", "qyj"}], "-", 
           RowBox[{"qwj", " ", "qzi"}], "+", 
           RowBox[{"qwi", " ", "qzj"}]}], ")"}]}], "+", 
        RowBox[{"qyij", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "qwj"}], " ", "qyi"}], "+", 
           RowBox[{"qwi", " ", "qyj"}], "-", 
           RowBox[{"qxj", " ", "qzi"}], "+", 
           RowBox[{"qxi", " ", "qzj"}]}], ")"}]}], "+", 
        RowBox[{"qxij", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "qwj"}], " ", "qxi"}], "+", 
           RowBox[{"qwi", " ", "qxj"}], "+", 
           RowBox[{"qyj", " ", "qzi"}], "-", 
           RowBox[{"qyi", " ", "qzj"}]}], ")"}]}], "+", 
        RowBox[{"qwij", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"qwi", " ", "qwj"}], "+", 
           RowBox[{"qxi", " ", "qxj"}], "+", 
           RowBox[{"qyi", " ", "qyj"}], "+", 
           RowBox[{"qzi", " ", "qzj"}]}], ")"}]}]}], "]"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"\[Sqrt]", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "qyij"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"qxj", " ", "qyi"}], "-", 
              RowBox[{"qxi", " ", "qyj"}], "-", 
              RowBox[{"qwj", " ", "qzi"}], "+", 
              RowBox[{"qwi", " ", "qzj"}]}], ")"}]}], "+", 
           RowBox[{"qzij", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "qwj"}], " ", "qyi"}], "+", 
              RowBox[{"qwi", " ", "qyj"}], "-", 
              RowBox[{"qxj", " ", "qzi"}], "+", 
              RowBox[{"qxi", " ", "qzj"}]}], ")"}]}], "+", 
           RowBox[{"qwij", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "qwj"}], " ", "qxi"}], "+", 
              RowBox[{"qwi", " ", "qxj"}], "+", 
              RowBox[{"qyj", " ", "qzi"}], "-", 
              RowBox[{"qyi", " ", "qzj"}]}], ")"}]}], "-", 
           RowBox[{"qxij", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"qwi", " ", "qwj"}], "+", 
              RowBox[{"qxi", " ", "qxj"}], "+", 
              RowBox[{"qyi", " ", "qyj"}], "+", 
              RowBox[{"qzi", " ", "qzj"}]}], ")"}]}]}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"qxij", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"qxj", " ", "qyi"}], "-", 
              RowBox[{"qxi", " ", "qyj"}], "-", 
              RowBox[{"qwj", " ", "qzi"}], "+", 
              RowBox[{"qwi", " ", "qzj"}]}], ")"}]}], "+", 
           RowBox[{"qwij", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "qwj"}], " ", "qyi"}], "+", 
              RowBox[{"qwi", " ", "qyj"}], "-", 
              RowBox[{"qxj", " ", "qzi"}], "+", 
              RowBox[{"qxi", " ", "qzj"}]}], ")"}]}], "-", 
           RowBox[{"qzij", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "qwj"}], " ", "qxi"}], "+", 
              RowBox[{"qwi", " ", "qxj"}], "+", 
              RowBox[{"qyj", " ", "qzi"}], "-", 
              RowBox[{"qyi", " ", "qzj"}]}], ")"}]}], "-", 
           RowBox[{"qyij", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"qwi", " ", "qwj"}], "+", 
              RowBox[{"qxi", " ", "qxj"}], "+", 
              RowBox[{"qyi", " ", "qyj"}], "+", 
              RowBox[{"qzi", " ", "qzj"}]}], ")"}]}]}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"qwij", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"qxj", " ", "qyi"}], "-", 
              RowBox[{"qxi", " ", "qyj"}], "-", 
              RowBox[{"qwj", " ", "qzi"}], "+", 
              RowBox[{"qwi", " ", "qzj"}]}], ")"}]}], "-", 
           RowBox[{"qxij", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "qwj"}], " ", "qyi"}], "+", 
              RowBox[{"qwi", " ", "qyj"}], "-", 
              RowBox[{"qxj", " ", "qzi"}], "+", 
              RowBox[{"qxi", " ", "qzj"}]}], ")"}]}], "+", 
           RowBox[{"qyij", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "qwj"}], " ", "qxi"}], "+", 
              RowBox[{"qwi", " ", "qxj"}], "+", 
              RowBox[{"qyj", " ", "qzi"}], "-", 
              RowBox[{"qyi", " ", "qzj"}]}], ")"}]}], "-", 
           RowBox[{"qzij", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"qwi", " ", "qwj"}], "+", 
              RowBox[{"qxi", " ", "qxj"}], "+", 
              RowBox[{"qyi", " ", "qyj"}], "+", 
              RowBox[{"qzi", " ", "qzj"}]}], ")"}]}]}], ")"}], "2"]}], 
       ")"}]}], ")"}]}], ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"qwij", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"qxj", " ", "qyi"}], "-", 
           RowBox[{"qxi", " ", "qyj"}], "-", 
           RowBox[{"qwj", " ", "qzi"}], "+", 
           RowBox[{"qwi", " ", "qzj"}]}], ")"}]}], "-", 
        RowBox[{"qxij", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "qwj"}], " ", "qyi"}], "+", 
           RowBox[{"qwi", " ", "qyj"}], "-", 
           RowBox[{"qxj", " ", "qzi"}], "+", 
           RowBox[{"qxi", " ", "qzj"}]}], ")"}]}], "+", 
        RowBox[{"qyij", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "qwj"}], " ", "qxi"}], "+", 
           RowBox[{"qwi", " ", "qxj"}], "+", 
           RowBox[{"qyj", " ", "qzi"}], "-", 
           RowBox[{"qyi", " ", "qzj"}]}], ")"}]}], "-", 
        RowBox[{"qzij", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"qwi", " ", "qwj"}], "+", 
           RowBox[{"qxi", " ", "qxj"}], "+", 
           RowBox[{"qyi", " ", "qyj"}], "+", 
           RowBox[{"qzi", " ", "qzj"}]}], ")"}]}]}], ")"}], " ", 
      RowBox[{"ArcCos", "[", 
       RowBox[{
        RowBox[{"qzij", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"qxj", " ", "qyi"}], "-", 
           RowBox[{"qxi", " ", "qyj"}], "-", 
           RowBox[{"qwj", " ", "qzi"}], "+", 
           RowBox[{"qwi", " ", "qzj"}]}], ")"}]}], "+", 
        RowBox[{"qyij", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "qwj"}], " ", "qyi"}], "+", 
           RowBox[{"qwi", " ", "qyj"}], "-", 
           RowBox[{"qxj", " ", "qzi"}], "+", 
           RowBox[{"qxi", " ", "qzj"}]}], ")"}]}], "+", 
        RowBox[{"qxij", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "qwj"}], " ", "qxi"}], "+", 
           RowBox[{"qwi", " ", "qxj"}], "+", 
           RowBox[{"qyj", " ", "qzi"}], "-", 
           RowBox[{"qyi", " ", "qzj"}]}], ")"}]}], "+", 
        RowBox[{"qwij", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"qwi", " ", "qwj"}], "+", 
           RowBox[{"qxi", " ", "qxj"}], "+", 
           RowBox[{"qyi", " ", "qyj"}], "+", 
           RowBox[{"qzi", " ", "qzj"}]}], ")"}]}]}], "]"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"\[Sqrt]", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "qyij"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"qxj", " ", "qyi"}], "-", 
              RowBox[{"qxi", " ", "qyj"}], "-", 
              RowBox[{"qwj", " ", "qzi"}], "+", 
              RowBox[{"qwi", " ", "qzj"}]}], ")"}]}], "+", 
           RowBox[{"qzij", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "qwj"}], " ", "qyi"}], "+", 
              RowBox[{"qwi", " ", "qyj"}], "-", 
              RowBox[{"qxj", " ", "qzi"}], "+", 
              RowBox[{"qxi", " ", "qzj"}]}], ")"}]}], "+", 
           RowBox[{"qwij", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "qwj"}], " ", "qxi"}], "+", 
              RowBox[{"qwi", " ", "qxj"}], "+", 
              RowBox[{"qyj", " ", "qzi"}], "-", 
              RowBox[{"qyi", " ", "qzj"}]}], ")"}]}], "-", 
           RowBox[{"qxij", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"qwi", " ", "qwj"}], "+", 
              RowBox[{"qxi", " ", "qxj"}], "+", 
              RowBox[{"qyi", " ", "qyj"}], "+", 
              RowBox[{"qzi", " ", "qzj"}]}], ")"}]}]}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"qxij", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"qxj", " ", "qyi"}], "-", 
              RowBox[{"qxi", " ", "qyj"}], "-", 
              RowBox[{"qwj", " ", "qzi"}], "+", 
              RowBox[{"qwi", " ", "qzj"}]}], ")"}]}], "+", 
           RowBox[{"qwij", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "qwj"}], " ", "qyi"}], "+", 
              RowBox[{"qwi", " ", "qyj"}], "-", 
              RowBox[{"qxj", " ", "qzi"}], "+", 
              RowBox[{"qxi", " ", "qzj"}]}], ")"}]}], "-", 
           RowBox[{"qzij", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "qwj"}], " ", "qxi"}], "+", 
              RowBox[{"qwi", " ", "qxj"}], "+", 
              RowBox[{"qyj", " ", "qzi"}], "-", 
              RowBox[{"qyi", " ", "qzj"}]}], ")"}]}], "-", 
           RowBox[{"qyij", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"qwi", " ", "qwj"}], "+", 
              RowBox[{"qxi", " ", "qxj"}], "+", 
              RowBox[{"qyi", " ", "qyj"}], "+", 
              RowBox[{"qzi", " ", "qzj"}]}], ")"}]}]}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"qwij", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"qxj", " ", "qyi"}], "-", 
              RowBox[{"qxi", " ", "qyj"}], "-", 
              RowBox[{"qwj", " ", "qzi"}], "+", 
              RowBox[{"qwi", " ", "qzj"}]}], ")"}]}], "-", 
           RowBox[{"qxij", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "qwj"}], " ", "qyi"}], "+", 
              RowBox[{"qwi", " ", "qyj"}], "-", 
              RowBox[{"qxj", " ", "qzi"}], "+", 
              RowBox[{"qxi", " ", "qzj"}]}], ")"}]}], "+", 
           RowBox[{"qyij", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "qwj"}], " ", "qxi"}], "+", 
              RowBox[{"qwi", " ", "qxj"}], "+", 
              RowBox[{"qyj", " ", "qzi"}], "-", 
              RowBox[{"qyi", " ", "qzj"}]}], ")"}]}], "-", 
           RowBox[{"qzij", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"qwi", " ", "qwj"}], "+", 
              RowBox[{"qxi", " ", "qxj"}], "+", 
              RowBox[{"qyi", " ", "qyj"}], "+", 
              RowBox[{"qzi", " ", "qzj"}]}], ")"}]}]}], ")"}], "2"]}], 
       ")"}]}], ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7376772701583157`*^9, 3.737677280268755*^9}, {
   3.737677324567296*^9, 3.7376773398961763`*^9}, 3.7376774929820223`*^9, {
   3.737677885411483*^9, 3.737677910165831*^9}, 3.7376780812410088`*^9, 
   3.7376781269544773`*^9, 3.737688773239655*^9, {3.737688813671877*^9, 
   3.737688836606388*^9}, {3.737688866821309*^9, 3.7376888819335012`*^9}, 
   3.737689042195417*^9, 3.737690082614574*^9, {3.737690467610957*^9, 
   3.7376904779912977`*^9}, {3.737690665728402*^9, 3.737690685400137*^9}, 
   3.737690733434564*^9, 3.73769089491859*^9, {3.737690965782113*^9, 
   3.7376909752341833`*^9}, 3.73769106082015*^9, {3.737691556038164*^9, 
   3.7376915778390923`*^9}, 3.737691649654977*^9, 3.737692381817615*^9, 
   3.737745315653523*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"pxi", "\[Rule]", "0.86972`"}], ",", 
   RowBox[{"pyi", "\[Rule]", "0.36348073`"}], ",", 
   RowBox[{"pzi", "\[Rule]", 
    RowBox[{"-", "0.63030591`"}]}], ",", 
   RowBox[{"pxj", "\[Rule]", "0.84388098`"}], ",", 
   RowBox[{"pyj", "\[Rule]", "0.84732604`"}], ",", 
   RowBox[{"pzj", "\[Rule]", 
    RowBox[{"-", "0.25890034`"}]}], ",", 
   RowBox[{"pxij", "\[Rule]", "0.25774847`"}], ",", 
   RowBox[{"pyij", "\[Rule]", "0.06106425`"}], ",", 
   RowBox[{"pzij", "\[Rule]", "0.60603896`"}], ",", 
   RowBox[{"qxi", "\[Rule]", 
    RowBox[{"-", "0.25738353`"}]}], ",", 
   RowBox[{"qyi", "\[Rule]", 
    RowBox[{"-", "0.0535528`"}]}], ",", 
   RowBox[{"qzi", "\[Rule]", "0.95436285`"}], ",", 
   RowBox[{"qwi", "\[Rule]", "0.14169462`"}], ",", 
   RowBox[{"qxj", "\[Rule]", 
    RowBox[{"-", "0.28314605`"}]}], ",", 
   RowBox[{"qyj", "\[Rule]", 
    RowBox[{"-", "0.55447087`"}]}], ",", 
   RowBox[{"qzj", "\[Rule]", 
    RowBox[{"-", "0.49128177`"}]}], ",", 
   RowBox[{"qwj", "\[Rule]", "0.60912445`"}], ",", 
   RowBox[{"qxij", "\[Rule]", 
    RowBox[{"-", "0.45908567`"}]}], ",", 
   RowBox[{"qyij", "\[Rule]", "0.37739565`"}], ",", 
   RowBox[{"qzij", "\[Rule]", 
    RowBox[{"-", "0.76267314`"}]}], ",", 
   RowBox[{"qwij", "\[Rule]", 
    RowBox[{"-", "0.25523039`"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7376772701583157`*^9, 3.737677280268755*^9}, {
   3.737677324567296*^9, 3.7376773398961763`*^9}, 3.7376774929820223`*^9, {
   3.737677885411483*^9, 3.737677910165831*^9}, 3.7376780812410088`*^9, 
   3.7376781269544773`*^9, 3.737688773239655*^9, {3.737688813671877*^9, 
   3.737688836606388*^9}, {3.737688866821309*^9, 3.7376888819335012`*^9}, 
   3.737689042195417*^9, 3.737690082614574*^9, {3.737690467610957*^9, 
   3.7376904779912977`*^9}, {3.737690665728402*^9, 3.737690685400137*^9}, 
   3.737690733434564*^9, 3.73769089491859*^9, {3.737690965782113*^9, 
   3.7376909752341833`*^9}, 3.73769106082015*^9, {3.737691556038164*^9, 
   3.7376915778390923`*^9}, 3.737691649654977*^9, 3.737692381817615*^9, 
   3.737745315660543*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.009775087095981108`", ",", "0.03887771122041826`", ",", 
   RowBox[{"-", "0.019441196808670493`"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7376772701583157`*^9, 3.737677280268755*^9}, {
   3.737677324567296*^9, 3.7376773398961763`*^9}, 3.7376774929820223`*^9, {
   3.737677885411483*^9, 3.737677910165831*^9}, 3.7376780812410088`*^9, 
   3.7376781269544773`*^9, 3.737688773239655*^9, {3.737688813671877*^9, 
   3.737688836606388*^9}, {3.737688866821309*^9, 3.7376888819335012`*^9}, 
   3.737689042195417*^9, 3.737690082614574*^9, {3.737690467610957*^9, 
   3.7376904779912977`*^9}, {3.737690665728402*^9, 3.737690685400137*^9}, 
   3.737690733434564*^9, 3.73769089491859*^9, {3.737690965782113*^9, 
   3.7376909752341833`*^9}, 3.73769106082015*^9, {3.737691556038164*^9, 
   3.7376915778390923`*^9}, 3.737691649654977*^9, 3.737692381817615*^9, 
   3.73774531566154*^9}],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   FrameBox[GridBox[{
      {
       ItemBox[
        TagBox[
         RowBox[{"{", 
          TemplateBox[{"1"},
           "OutputSizeLimit`Skeleton",
           DisplayFunction->(FrameBox[
             RowBox[{"\" \[CenterEllipsis]\"", #, "\"\[CenterEllipsis] \""}], 
             Background -> GrayLevel[0.75], 
             BaseStyle -> {
              "Deploy", FontColor -> GrayLevel[1], FontSize -> Smaller, 
               ShowStringCharacters -> False}, BaselinePosition -> Baseline, 
             ContentPadding -> False, FrameMargins -> 1, FrameStyle -> 
             GrayLevel[0.75], RoundingRadius -> 7]& )], "}"}],
         Short[#, 5]& ],
        BaseStyle->{Deployed -> False},
        StripOnInput->False]},
      {GridBox[{
         {
          TagBox[
           TooltipBox[
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource[
                "FEStrings", "sizeBriefExplanation"], StandardForm],
               ImageSizeCache->{74., {2., 8.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarCategory",
             StripOnInput->False],
            StyleBox[
             DynamicBox[
              ToBoxes[
               FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"], 
               StandardForm]], DynamicUpdating -> True, StripOnInput -> 
             False]],
           Annotation[#, 
            Style[
             Dynamic[
              FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"]], 
             DynamicUpdating -> True], "Tooltip"]& ], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm],
               ImageSizeCache->{67., {0., 8.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            Identity, 38, 26624326175706190764, 5/2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm],
               ImageSizeCache->{73., {0., 8.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            Identity, 38, 26624326175706190764, 5 2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm],
               ImageSizeCache->{56., {0., 8.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            Identity, 38, 26624326175706190764, Infinity],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm],
               ImageSizeCache->{100., {0., 8.}}],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True], "SuggestionsBarControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, 25}],
           Appearance->None,
           ButtonFunction:>FrontEndExecute[{
              FrontEnd`SetOptions[
              FrontEnd`$FrontEnd, 
               FrontEnd`PreferencesSettings -> {"Page" -> "Evaluation"}], 
              FrontEnd`FrontEndToken["PreferencesDialog"]}],
           Evaluator->None,
           Method->"Preemptive"]}
        },
        AutoDelete->False,
        FrameStyle->GrayLevel[0.85],
        GridBoxDividers->{"Columns" -> {False, {True}}},
        GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
        GridBoxSpacings->{"Columns" -> {{2}}}]}
     },
     DefaultBaseStyle->"Column",
     GridBoxAlignment->{
      "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
       "RowsIndexed" -> {}},
     GridBoxDividers->{
      "Columns" -> {{False}}, "ColumnsIndexed" -> {}, "Rows" -> {{False}}, 
       "RowsIndexed" -> {}},
     GridBoxItemSize->{
      "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
       "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], 
         Offset[1.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Background->RGBColor[0.9657, 0.9753, 0.9802],
    FrameMargins->{{12, 12}, {0, 15}},
    FrameStyle->GrayLevel[0.85],
    RoundingRadius->5,
    StripOnInput->False],
   Deploy,
   DefaultBaseStyle->"Deploy"],
  Out[38]]], "Output",
 CellChangeTimes->{{3.7376772701583157`*^9, 3.737677280268755*^9}, {
   3.737677324567296*^9, 3.7376773398961763`*^9}, 3.7376774929820223`*^9, {
   3.737677885411483*^9, 3.737677910165831*^9}, 3.7376780812410088`*^9, 
   3.7376781269544773`*^9, 3.737688773239655*^9, {3.737688813671877*^9, 
   3.737688836606388*^9}, {3.737688866821309*^9, 3.7376888819335012`*^9}, 
   3.737689042195417*^9, 3.737690082614574*^9, {3.737690467610957*^9, 
   3.7376904779912977`*^9}, {3.737690665728402*^9, 3.737690685400137*^9}, 
   3.737690733434564*^9, 3.73769089491859*^9, {3.737690965782113*^9, 
   3.7376909752341833`*^9}, 3.73769106082015*^9, {3.737691556038164*^9, 
   3.7376915778390923`*^9}, 3.737691649654977*^9, 3.737692381817615*^9, 
   3.737745315683566*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"q2lqv", "[", "qi", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"q2lqv", "[", "qi", "]"}], ",", 
    RowBox[{"{", "qi", "}"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"%", "/.", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"1", "-", 
      SuperscriptBox["qwi", "2"]}], "\[Rule]", "s2"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      SuperscriptBox["qxi", "2"], "+", 
      SuperscriptBox["qyi", "2"], "+", 
      SuperscriptBox["qzi", "2"]}], "\[Rule]", "n2"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ArcCos", "[", "qwi", "]"}], " ", "\[Rule]", " ", "h"}]}], 
   "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{"%", " ", "*", " ", 
   RowBox[{"(", 
    SuperscriptBox["n2", "1.5"], ")"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7376784623650007`*^9, 3.737678478004849*^9}, {
   3.737678588891066*^9, 3.7376786439305277`*^9}, {3.737678710105159*^9, 
   3.73767878816155*^9}, {3.737679042044066*^9, 3.737679079210947*^9}, 
   3.7377494757428503`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{"qxi", " ", 
     RowBox[{"ArcCos", "[", "qwi", "]"}]}], 
    SqrtBox[
     RowBox[{
      SuperscriptBox["qxi", "2"], "+", 
      SuperscriptBox["qyi", "2"], "+", 
      SuperscriptBox["qzi", "2"]}]]], ",", 
   FractionBox[
    RowBox[{"qyi", " ", 
     RowBox[{"ArcCos", "[", "qwi", "]"}]}], 
    SqrtBox[
     RowBox[{
      SuperscriptBox["qxi", "2"], "+", 
      SuperscriptBox["qyi", "2"], "+", 
      SuperscriptBox["qzi", "2"]}]]], ",", 
   FractionBox[
    RowBox[{"qzi", " ", 
     RowBox[{"ArcCos", "[", "qwi", "]"}]}], 
    SqrtBox[
     RowBox[{
      SuperscriptBox["qxi", "2"], "+", 
      SuperscriptBox["qyi", "2"], "+", 
      SuperscriptBox["qzi", "2"]}]]]}], "}"}]], "Output",
 CellChangeTimes->{{3.737678474262247*^9, 3.7376784783338547`*^9}, 
   3.737678542198802*^9, {3.737678604678422*^9, 3.737678644236577*^9}, {
   3.737678712706747*^9, 3.737678789728154*^9}, {3.73767904266916*^9, 
   3.7376790794513807`*^9}, 3.7376887732515078`*^9, 3.737689655454296*^9, 
   3.7377453157071238`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["qxi", "2"], " ", 
         RowBox[{"ArcCos", "[", "qwi", "]"}]}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["qxi", "2"], "+", 
           SuperscriptBox["qyi", "2"], "+", 
           SuperscriptBox["qzi", "2"]}], ")"}], 
         RowBox[{"3", "/", "2"}]]]}], "+", 
      FractionBox[
       RowBox[{"ArcCos", "[", "qwi", "]"}], 
       SqrtBox[
        RowBox[{
         SuperscriptBox["qxi", "2"], "+", 
         SuperscriptBox["qyi", "2"], "+", 
         SuperscriptBox["qzi", "2"]}]]]}], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"qxi", " ", "qyi", " ", 
        RowBox[{"ArcCos", "[", "qwi", "]"}]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["qxi", "2"], "+", 
          SuperscriptBox["qyi", "2"], "+", 
          SuperscriptBox["qzi", "2"]}], ")"}], 
        RowBox[{"3", "/", "2"}]]]}], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"qxi", " ", "qzi", " ", 
        RowBox[{"ArcCos", "[", "qwi", "]"}]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["qxi", "2"], "+", 
          SuperscriptBox["qyi", "2"], "+", 
          SuperscriptBox["qzi", "2"]}], ")"}], 
        RowBox[{"3", "/", "2"}]]]}], ",", 
     RowBox[{"-", 
      FractionBox["qxi", 
       RowBox[{
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["qwi", "2"]}]], " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["qxi", "2"], "+", 
          SuperscriptBox["qyi", "2"], "+", 
          SuperscriptBox["qzi", "2"]}]]}]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"qxi", " ", "qyi", " ", 
        RowBox[{"ArcCos", "[", "qwi", "]"}]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["qxi", "2"], "+", 
          SuperscriptBox["qyi", "2"], "+", 
          SuperscriptBox["qzi", "2"]}], ")"}], 
        RowBox[{"3", "/", "2"}]]]}], ",", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["qyi", "2"], " ", 
         RowBox[{"ArcCos", "[", "qwi", "]"}]}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["qxi", "2"], "+", 
           SuperscriptBox["qyi", "2"], "+", 
           SuperscriptBox["qzi", "2"]}], ")"}], 
         RowBox[{"3", "/", "2"}]]]}], "+", 
      FractionBox[
       RowBox[{"ArcCos", "[", "qwi", "]"}], 
       SqrtBox[
        RowBox[{
         SuperscriptBox["qxi", "2"], "+", 
         SuperscriptBox["qyi", "2"], "+", 
         SuperscriptBox["qzi", "2"]}]]]}], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"qyi", " ", "qzi", " ", 
        RowBox[{"ArcCos", "[", "qwi", "]"}]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["qxi", "2"], "+", 
          SuperscriptBox["qyi", "2"], "+", 
          SuperscriptBox["qzi", "2"]}], ")"}], 
        RowBox[{"3", "/", "2"}]]]}], ",", 
     RowBox[{"-", 
      FractionBox["qyi", 
       RowBox[{
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["qwi", "2"]}]], " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["qxi", "2"], "+", 
          SuperscriptBox["qyi", "2"], "+", 
          SuperscriptBox["qzi", "2"]}]]}]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"qxi", " ", "qzi", " ", 
        RowBox[{"ArcCos", "[", "qwi", "]"}]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["qxi", "2"], "+", 
          SuperscriptBox["qyi", "2"], "+", 
          SuperscriptBox["qzi", "2"]}], ")"}], 
        RowBox[{"3", "/", "2"}]]]}], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"qyi", " ", "qzi", " ", 
        RowBox[{"ArcCos", "[", "qwi", "]"}]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["qxi", "2"], "+", 
          SuperscriptBox["qyi", "2"], "+", 
          SuperscriptBox["qzi", "2"]}], ")"}], 
        RowBox[{"3", "/", "2"}]]]}], ",", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["qzi", "2"], " ", 
         RowBox[{"ArcCos", "[", "qwi", "]"}]}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["qxi", "2"], "+", 
           SuperscriptBox["qyi", "2"], "+", 
           SuperscriptBox["qzi", "2"]}], ")"}], 
         RowBox[{"3", "/", "2"}]]]}], "+", 
      FractionBox[
       RowBox[{"ArcCos", "[", "qwi", "]"}], 
       SqrtBox[
        RowBox[{
         SuperscriptBox["qxi", "2"], "+", 
         SuperscriptBox["qyi", "2"], "+", 
         SuperscriptBox["qzi", "2"]}]]]}], ",", 
     RowBox[{"-", 
      FractionBox["qzi", 
       RowBox[{
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["qwi", "2"]}]], " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["qxi", "2"], "+", 
          SuperscriptBox["qyi", "2"], "+", 
          SuperscriptBox["qzi", "2"]}]]}]]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.737678474262247*^9, 3.7376784783338547`*^9}, 
   3.737678542198802*^9, {3.737678604678422*^9, 3.737678644236577*^9}, {
   3.737678712706747*^9, 3.737678789728154*^9}, {3.73767904266916*^9, 
   3.7376790794513807`*^9}, 3.7376887732515078`*^9, 3.737689655454296*^9, 
   3.737745315708064*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox["h", 
       SqrtBox["n2"]], "-", 
      FractionBox[
       RowBox[{"h", " ", 
        SuperscriptBox["qxi", "2"]}], 
       SuperscriptBox["n2", 
        RowBox[{"3", "/", "2"}]]]}], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"h", " ", "qxi", " ", "qyi"}], 
       SuperscriptBox["n2", 
        RowBox[{"3", "/", "2"}]]]}], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"h", " ", "qxi", " ", "qzi"}], 
       SuperscriptBox["n2", 
        RowBox[{"3", "/", "2"}]]]}], ",", 
     RowBox[{"-", 
      FractionBox["qxi", 
       RowBox[{
        SqrtBox["n2"], " ", 
        SqrtBox["s2"]}]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"h", " ", "qxi", " ", "qyi"}], 
       SuperscriptBox["n2", 
        RowBox[{"3", "/", "2"}]]]}], ",", 
     RowBox[{
      FractionBox["h", 
       SqrtBox["n2"]], "-", 
      FractionBox[
       RowBox[{"h", " ", 
        SuperscriptBox["qyi", "2"]}], 
       SuperscriptBox["n2", 
        RowBox[{"3", "/", "2"}]]]}], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"h", " ", "qyi", " ", "qzi"}], 
       SuperscriptBox["n2", 
        RowBox[{"3", "/", "2"}]]]}], ",", 
     RowBox[{"-", 
      FractionBox["qyi", 
       RowBox[{
        SqrtBox["n2"], " ", 
        SqrtBox["s2"]}]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"h", " ", "qxi", " ", "qzi"}], 
       SuperscriptBox["n2", 
        RowBox[{"3", "/", "2"}]]]}], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"h", " ", "qyi", " ", "qzi"}], 
       SuperscriptBox["n2", 
        RowBox[{"3", "/", "2"}]]]}], ",", 
     RowBox[{
      FractionBox["h", 
       SqrtBox["n2"]], "-", 
      FractionBox[
       RowBox[{"h", " ", 
        SuperscriptBox["qzi", "2"]}], 
       SuperscriptBox["n2", 
        RowBox[{"3", "/", "2"}]]]}], ",", 
     RowBox[{"-", 
      FractionBox["qzi", 
       RowBox[{
        SqrtBox["n2"], " ", 
        SqrtBox["s2"]}]]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.737678474262247*^9, 3.7376784783338547`*^9}, 
   3.737678542198802*^9, {3.737678604678422*^9, 3.737678644236577*^9}, {
   3.737678712706747*^9, 3.737678789728154*^9}, {3.73767904266916*^9, 
   3.7376790794513807`*^9}, 3.7376887732515078`*^9, 3.737689655454296*^9, 
   3.737745315709166*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1.`", " ", "h", " ", 
      RowBox[{"(", 
       RowBox[{"n2", "-", 
        RowBox[{"1.`", " ", 
         SuperscriptBox["qxi", "2"]}]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{"-", "1.`"}], " ", "h", " ", "qxi", " ", "qyi"}], ",", 
     RowBox[{
      RowBox[{"-", "1.`"}], " ", "h", " ", "qxi", " ", "qzi"}], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["n2", "1.`"], " ", "qxi"}], 
       SqrtBox["s2"]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "1.`"}], " ", "h", " ", "qxi", " ", "qyi"}], ",", 
     RowBox[{"1.`", " ", "h", " ", 
      RowBox[{"(", 
       RowBox[{"n2", "-", 
        RowBox[{"1.`", " ", 
         SuperscriptBox["qyi", "2"]}]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{"-", "1.`"}], " ", "h", " ", "qyi", " ", "qzi"}], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["n2", "1.`"], " ", "qyi"}], 
       SqrtBox["s2"]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "1.`"}], " ", "h", " ", "qxi", " ", "qzi"}], ",", 
     RowBox[{
      RowBox[{"-", "1.`"}], " ", "h", " ", "qyi", " ", "qzi"}], ",", 
     RowBox[{"1.`", " ", "h", " ", 
      RowBox[{"(", 
       RowBox[{"n2", "-", 
        RowBox[{"1.`", " ", 
         SuperscriptBox["qzi", "2"]}]}], ")"}]}], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["n2", "1.`"], " ", "qzi"}], 
       SqrtBox["s2"]]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.737678474262247*^9, 3.7376784783338547`*^9}, 
   3.737678542198802*^9, {3.737678604678422*^9, 3.737678644236577*^9}, {
   3.737678712706747*^9, 3.737678789728154*^9}, {3.73767904266916*^9, 
   3.7376790794513807`*^9}, 3.7376887732515078`*^9, 3.737689655454296*^9, 
   3.73774531571093*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"D", "[", " ", 
   RowBox[{
    RowBox[{"qxq", "[", 
     RowBox[{
      RowBox[{"qinv", "[", "qi", "]"}], ",", " ", "qj"}], "]"}], ",", " ", 
    RowBox[{"{", "qi", "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"D", "[", " ", 
  RowBox[{
   RowBox[{"qxq", "[", 
    RowBox[{
     RowBox[{"qinv", "[", "qi", "]"}], ",", " ", "qj"}], "]"}], ",", " ", 
   RowBox[{"{", "qj", "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"%", "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"qxi", "\[Rule]", "x"}], ",", " ", 
    RowBox[{"qyi", "\[Rule]", "y"}], ",", " ", 
    RowBox[{"qzi", "\[Rule]", "z"}], ",", " ", 
    RowBox[{"qwi", "\[Rule]", "w"}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.7377453223487988`*^9, 3.737745334347364*^9}, {
  3.737745755112503*^9, 3.73774577810367*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"qwi", ",", "qzi", ",", 
     RowBox[{"-", "qyi"}], ",", 
     RowBox[{"-", "qxi"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "qzi"}], ",", "qwi", ",", "qxi", ",", 
     RowBox[{"-", "qyi"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"qyi", ",", 
     RowBox[{"-", "qxi"}], ",", "qwi", ",", 
     RowBox[{"-", "qzi"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"qxi", ",", "qyi", ",", "qzi", ",", "qwi"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.737745335158451*^9, {3.737745759889983*^9, 3.7377457788212233`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"w", ",", "z", ",", 
     RowBox[{"-", "y"}], ",", 
     RowBox[{"-", "x"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "z"}], ",", "w", ",", "x", ",", 
     RowBox[{"-", "y"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"y", ",", 
     RowBox[{"-", "x"}], ",", "w", ",", 
     RowBox[{"-", "z"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y", ",", "z", ",", "w"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.737745335158451*^9, {3.737745759889983*^9, 3.737745778821693*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"D", "[", 
  RowBox[{"%", ",", " ", 
   RowBox[{"{", "qj", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.737745349950144*^9, 3.737745351963892*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.7377453522570343`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"qxq", "[", 
     RowBox[{
      RowBox[{"qinv", "[", "qij", "]"}], ",", " ", 
      RowBox[{"qxq", "[", 
       RowBox[{
        RowBox[{"qinv", "[", "qi", "]"}], ",", "qj"}], "]"}]}], "]"}], ",", 
    " ", 
    RowBox[{"{", "qi", "}"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"dqiiqjdqi", " ", "=", " ", 
  RowBox[{"D", "[", " ", 
   RowBox[{
    RowBox[{"qxq", "[", 
     RowBox[{
      RowBox[{"qinv", "[", "qi", "]"}], ",", " ", "qj"}], "]"}], ",", " ", 
    RowBox[{"{", "qi", "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"dqiiqjdqi", "[", 
  RowBox[{"[", 
   RowBox[{";;", ",", " ", "1"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"qxq", "[", 
  RowBox[{
   RowBox[{"qinv", "[", "qij", "]"}], ",", " ", "%"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"qxq", "[", 
    RowBox[{
     RowBox[{"qinv", "[", "qij", "]"}], ","}], " "}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.737745861572694*^9, 3.737746014490892*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", "qwij"}], " ", "qwj"}], "-", 
      RowBox[{"qxij", " ", "qxj"}], "+", 
      RowBox[{"qyij", " ", "qyj"}], "+", 
      RowBox[{"qzij", " ", "qzj"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "qxj"}], " ", "qyij"}], "-", 
      RowBox[{"qxij", " ", "qyj"}], "-", 
      RowBox[{"qwj", " ", "qzij"}], "-", 
      RowBox[{"qwij", " ", "qzj"}]}], ",", 
     RowBox[{
      RowBox[{"qwj", " ", "qyij"}], "+", 
      RowBox[{"qwij", " ", "qyj"}], "-", 
      RowBox[{"qxj", " ", "qzij"}], "-", 
      RowBox[{"qxij", " ", "qzj"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "qwj"}], " ", "qxij"}], "+", 
      RowBox[{"qwij", " ", "qxj"}], "+", 
      RowBox[{"qyj", " ", "qzij"}], "-", 
      RowBox[{"qyij", " ", "qzj"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", "qxj"}], " ", "qyij"}], "-", 
      RowBox[{"qxij", " ", "qyj"}], "+", 
      RowBox[{"qwj", " ", "qzij"}], "+", 
      RowBox[{"qwij", " ", "qzj"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "qwij"}], " ", "qwj"}], "+", 
      RowBox[{"qxij", " ", "qxj"}], "-", 
      RowBox[{"qyij", " ", "qyj"}], "+", 
      RowBox[{"qzij", " ", "qzj"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "qwj"}], " ", "qxij"}], "-", 
      RowBox[{"qwij", " ", "qxj"}], "-", 
      RowBox[{"qyj", " ", "qzij"}], "-", 
      RowBox[{"qyij", " ", "qzj"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "qwj"}], " ", "qyij"}], "+", 
      RowBox[{"qwij", " ", "qyj"}], "-", 
      RowBox[{"qxj", " ", "qzij"}], "+", 
      RowBox[{"qxij", " ", "qzj"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", "qwj"}], " ", "qyij"}], "-", 
      RowBox[{"qwij", " ", "qyj"}], "-", 
      RowBox[{"qxj", " ", "qzij"}], "-", 
      RowBox[{"qxij", " ", "qzj"}]}], ",", 
     RowBox[{
      RowBox[{"qwj", " ", "qxij"}], "+", 
      RowBox[{"qwij", " ", "qxj"}], "-", 
      RowBox[{"qyj", " ", "qzij"}], "-", 
      RowBox[{"qyij", " ", "qzj"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "qwij"}], " ", "qwj"}], "+", 
      RowBox[{"qxij", " ", "qxj"}], "+", 
      RowBox[{"qyij", " ", "qyj"}], "-", 
      RowBox[{"qzij", " ", "qzj"}]}], ",", 
     RowBox[{
      RowBox[{"qxj", " ", "qyij"}], "-", 
      RowBox[{"qxij", " ", "qyj"}], "-", 
      RowBox[{"qwj", " ", "qzij"}], "+", 
      RowBox[{"qwij", " ", "qzj"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", "qwj"}], " ", "qxij"}], "+", 
      RowBox[{"qwij", " ", "qxj"}], "-", 
      RowBox[{"qyj", " ", "qzij"}], "+", 
      RowBox[{"qyij", " ", "qzj"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "qwj"}], " ", "qyij"}], "+", 
      RowBox[{"qwij", " ", "qyj"}], "+", 
      RowBox[{"qxj", " ", "qzij"}], "-", 
      RowBox[{"qxij", " ", "qzj"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "qxj"}], " ", "qyij"}], "+", 
      RowBox[{"qxij", " ", "qyj"}], "-", 
      RowBox[{"qwj", " ", "qzij"}], "+", 
      RowBox[{"qwij", " ", "qzj"}]}], ",", 
     RowBox[{
      RowBox[{"qwij", " ", "qwj"}], "+", 
      RowBox[{"qxij", " ", "qxj"}], "+", 
      RowBox[{"qyij", " ", "qyj"}], "+", 
      RowBox[{"qzij", " ", "qzj"}]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.737745878341124*^9, {3.737745962412932*^9, 3.737746014725053*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "qwj"}], ",", 
     RowBox[{"-", "qzj"}], ",", "qyj", ",", "qxj"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"qzj", ",", 
     RowBox[{"-", "qwj"}], ",", 
     RowBox[{"-", "qxj"}], ",", "qyj"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "qyj"}], ",", "qxj", ",", 
     RowBox[{"-", "qwj"}], ",", "qzj"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"qxj", ",", "qyj", ",", "qzj", ",", "qwj"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.737745878341124*^9, {3.737745962412932*^9, 3.737746014725999*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "qwj"}], ",", "qzj", ",", 
   RowBox[{"-", "qyj"}], ",", "qxj"}], "}"}]], "Output",
 CellChangeTimes->{
  3.737745878341124*^9, {3.737745962412932*^9, 3.737746014726531*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", "qwij"}], " ", "qwj"}], "-", 
    RowBox[{"qxij", " ", "qxj"}], "+", 
    RowBox[{"qyij", " ", "qyj"}], "+", 
    RowBox[{"qzij", " ", "qzj"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "qxj"}], " ", "qyij"}], "-", 
    RowBox[{"qxij", " ", "qyj"}], "+", 
    RowBox[{"qwj", " ", "qzij"}], "+", 
    RowBox[{"qwij", " ", "qzj"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "qwj"}], " ", "qyij"}], "-", 
    RowBox[{"qwij", " ", "qyj"}], "-", 
    RowBox[{"qxj", " ", "qzij"}], "-", 
    RowBox[{"qxij", " ", "qzj"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "qwj"}], " ", "qxij"}], "+", 
    RowBox[{"qwij", " ", "qxj"}], "-", 
    RowBox[{"qyj", " ", "qzij"}], "+", 
    RowBox[{"qyij", " ", "qzj"}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.737745878341124*^9, {3.737745962412932*^9, 3.737746014727078*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"D", "[", 
  RowBox[{
   RowBox[{"qxq", "[", 
    RowBox[{"qi", ",", "qj"}], "]"}], ",", " ", 
   RowBox[{"{", "qj", "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"%", ".", "qj"}], "\[IndentingNewLine]", 
 RowBox[{"qxq", "[", 
  RowBox[{"qi", ",", "qj"}], "]"}]}], "Input",
 CellChangeTimes->{{3.737746117033772*^9, 3.73774613201801*^9}, {
  3.73774630946454*^9, 3.737746314495495*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"qwi", ",", 
     RowBox[{"-", "qzi"}], ",", "qyi", ",", "qxi"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"qzi", ",", "qwi", ",", 
     RowBox[{"-", "qxi"}], ",", "qyi"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "qyi"}], ",", "qxi", ",", "qwi", ",", "qzi"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "qxi"}], ",", 
     RowBox[{"-", "qyi"}], ",", 
     RowBox[{"-", "qzi"}], ",", "qwi"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7377461282634974`*^9, 3.737746132171974*^9}, {
  3.737746310810977*^9, 3.737746314670945*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"qwj", " ", "qxi"}], "+", 
    RowBox[{"qwi", " ", "qxj"}], "-", 
    RowBox[{"qyj", " ", "qzi"}], "+", 
    RowBox[{"qyi", " ", "qzj"}]}], ",", 
   RowBox[{
    RowBox[{"qwj", " ", "qyi"}], "+", 
    RowBox[{"qwi", " ", "qyj"}], "+", 
    RowBox[{"qxj", " ", "qzi"}], "-", 
    RowBox[{"qxi", " ", "qzj"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "qxj"}], " ", "qyi"}], "+", 
    RowBox[{"qxi", " ", "qyj"}], "+", 
    RowBox[{"qwj", " ", "qzi"}], "+", 
    RowBox[{"qwi", " ", "qzj"}]}], ",", 
   RowBox[{
    RowBox[{"qwi", " ", "qwj"}], "-", 
    RowBox[{"qxi", " ", "qxj"}], "-", 
    RowBox[{"qyi", " ", "qyj"}], "-", 
    RowBox[{"qzi", " ", "qzj"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7377461282634974`*^9, 3.737746132171974*^9}, {
  3.737746310810977*^9, 3.7377463146715097`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"qwj", " ", "qxi"}], "+", 
    RowBox[{"qwi", " ", "qxj"}], "-", 
    RowBox[{"qyj", " ", "qzi"}], "+", 
    RowBox[{"qyi", " ", "qzj"}]}], ",", 
   RowBox[{
    RowBox[{"qwj", " ", "qyi"}], "+", 
    RowBox[{"qwi", " ", "qyj"}], "+", 
    RowBox[{"qxj", " ", "qzi"}], "-", 
    RowBox[{"qxi", " ", "qzj"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "qxj"}], " ", "qyi"}], "+", 
    RowBox[{"qxi", " ", "qyj"}], "+", 
    RowBox[{"qwj", " ", "qzi"}], "+", 
    RowBox[{"qwi", " ", "qzj"}]}], ",", 
   RowBox[{
    RowBox[{"qwi", " ", "qwj"}], "-", 
    RowBox[{"qxi", " ", "qxj"}], "-", 
    RowBox[{"qyi", " ", "qyj"}], "-", 
    RowBox[{"qzi", " ", "qzj"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7377461282634974`*^9, 3.737746132171974*^9}, {
  3.737746310810977*^9, 3.7377463146720133`*^9}}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7377463005038347`*^9, 3.7377463013995523`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"qxq", "[", 
     RowBox[{"qi", ",", "qj"}], "]"}], ",", " ", 
    RowBox[{"{", "qi", "}"}]}], "]"}], " ", 
  RowBox[{"(*", " ", "qr2Q", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"%", "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"qxj", "\[Rule]", "x"}], ",", 
    RowBox[{"qyj", "\[Rule]", "y"}], ",", 
    RowBox[{"qzj", "\[Rule]", "z"}], ",", 
    RowBox[{"qwj", "\[Rule]", "w"}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"qxq", "[", 
     RowBox[{"qi", ",", "qj"}], "]"}], ",", " ", 
    RowBox[{"{", "qj", "}"}]}], "]"}], 
  RowBox[{"(*", " ", "ql2Q", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"%", "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"qxi", "\[Rule]", "x"}], ",", 
    RowBox[{"qyi", "\[Rule]", "y"}], ",", 
    RowBox[{"qzi", "\[Rule]", "z"}], ",", 
    RowBox[{"qwi", "\[Rule]", "w"}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.7377464422505083`*^9, 3.737746444981266*^9}, {
  3.737748688063204*^9, 3.737748748045434*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"qwj", ",", "qzj", ",", 
     RowBox[{"-", "qyj"}], ",", "qxj"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "qzj"}], ",", "qwj", ",", "qxj", ",", "qyj"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"qyj", ",", 
     RowBox[{"-", "qxj"}], ",", "qwj", ",", "qzj"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "qxj"}], ",", 
     RowBox[{"-", "qyj"}], ",", 
     RowBox[{"-", "qzj"}], ",", "qwj"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.737746448285577*^9, {3.737748731697057*^9, 3.73774874859508*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"w", ",", "z", ",", 
     RowBox[{"-", "y"}], ",", "x"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "z"}], ",", "w", ",", "x", ",", "y"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"y", ",", 
     RowBox[{"-", "x"}], ",", "w", ",", "z"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "x"}], ",", 
     RowBox[{"-", "y"}], ",", 
     RowBox[{"-", "z"}], ",", "w"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.737746448285577*^9, {3.737748731697057*^9, 3.7377487485957117`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"qwi", ",", 
     RowBox[{"-", "qzi"}], ",", "qyi", ",", "qxi"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"qzi", ",", "qwi", ",", 
     RowBox[{"-", "qxi"}], ",", "qyi"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "qyi"}], ",", "qxi", ",", "qwi", ",", "qzi"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "qxi"}], ",", 
     RowBox[{"-", "qyi"}], ",", 
     RowBox[{"-", "qzi"}], ",", "qwi"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.737746448285577*^9, {3.737748731697057*^9, 3.737748748596115*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"w", ",", 
     RowBox[{"-", "z"}], ",", "y", ",", "x"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"z", ",", "w", ",", 
     RowBox[{"-", "x"}], ",", "y"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "y"}], ",", "x", ",", "w", ",", "z"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "x"}], ",", 
     RowBox[{"-", "y"}], ",", 
     RowBox[{"-", "z"}], ",", "w"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.737746448285577*^9, {3.737748731697057*^9, 3.737748748596483*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"D", "[", 
  RowBox[{
   RowBox[{"q2r", "[", 
    RowBox[{"qinv", "[", "qi", "]"}], "]"}], ",", " ", 
   RowBox[{"{", "qi", "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"%", "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"qxi", "\[Rule]", "x"}], ",", 
    RowBox[{"qyi", "\[Rule]", "y"}], ",", 
    RowBox[{"qzi", "\[Rule]", "z"}], ",", 
    RowBox[{"qwi", "\[Rule]", "w"}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.7377466405725317`*^9, 3.737746652816927*^9}, {
  3.7377468612522984`*^9, 3.737746904746888*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{
        RowBox[{"-", "4"}], " ", "qyi"}], ",", 
       RowBox[{
        RowBox[{"-", "4"}], " ", "qzi"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"2", " ", "qyi"}], ",", 
       RowBox[{"2", " ", "qxi"}], ",", 
       RowBox[{"2", " ", "qwi"}], ",", 
       RowBox[{"2", " ", "qzi"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"2", " ", "qzi"}], ",", 
       RowBox[{
        RowBox[{"-", "2"}], " ", "qwi"}], ",", 
       RowBox[{"2", " ", "qxi"}], ",", 
       RowBox[{
        RowBox[{"-", "2"}], " ", "qyi"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"2", " ", "qyi"}], ",", 
       RowBox[{"2", " ", "qxi"}], ",", 
       RowBox[{
        RowBox[{"-", "2"}], " ", "qwi"}], ",", 
       RowBox[{
        RowBox[{"-", "2"}], " ", "qzi"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "4"}], " ", "qxi"}], ",", "0", ",", 
       RowBox[{
        RowBox[{"-", "4"}], " ", "qzi"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"2", " ", "qwi"}], ",", 
       RowBox[{"2", " ", "qzi"}], ",", 
       RowBox[{"2", " ", "qyi"}], ",", 
       RowBox[{"2", " ", "qxi"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"2", " ", "qzi"}], ",", 
       RowBox[{"2", " ", "qwi"}], ",", 
       RowBox[{"2", " ", "qxi"}], ",", 
       RowBox[{"2", " ", "qyi"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", "qwi"}], ",", 
       RowBox[{"2", " ", "qzi"}], ",", 
       RowBox[{"2", " ", "qyi"}], ",", 
       RowBox[{
        RowBox[{"-", "2"}], " ", "qxi"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "4"}], " ", "qxi"}], ",", 
       RowBox[{
        RowBox[{"-", "4"}], " ", "qyi"}], ",", "0", ",", "0"}], "}"}]}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7377466532722282`*^9, {3.737746874477056*^9, 3.737746905078985*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{
        RowBox[{"-", "4"}], " ", "y"}], ",", 
       RowBox[{
        RowBox[{"-", "4"}], " ", "z"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"2", " ", "y"}], ",", 
       RowBox[{"2", " ", "x"}], ",", 
       RowBox[{"2", " ", "w"}], ",", 
       RowBox[{"2", " ", "z"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"2", " ", "z"}], ",", 
       RowBox[{
        RowBox[{"-", "2"}], " ", "w"}], ",", 
       RowBox[{"2", " ", "x"}], ",", 
       RowBox[{
        RowBox[{"-", "2"}], " ", "y"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"2", " ", "y"}], ",", 
       RowBox[{"2", " ", "x"}], ",", 
       RowBox[{
        RowBox[{"-", "2"}], " ", "w"}], ",", 
       RowBox[{
        RowBox[{"-", "2"}], " ", "z"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "4"}], " ", "x"}], ",", "0", ",", 
       RowBox[{
        RowBox[{"-", "4"}], " ", "z"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"2", " ", "w"}], ",", 
       RowBox[{"2", " ", "z"}], ",", 
       RowBox[{"2", " ", "y"}], ",", 
       RowBox[{"2", " ", "x"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"2", " ", "z"}], ",", 
       RowBox[{"2", " ", "w"}], ",", 
       RowBox[{"2", " ", "x"}], ",", 
       RowBox[{"2", " ", "y"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", "w"}], ",", 
       RowBox[{"2", " ", "z"}], ",", 
       RowBox[{"2", " ", "y"}], ",", 
       RowBox[{
        RowBox[{"-", "2"}], " ", "x"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "4"}], " ", "x"}], ",", 
       RowBox[{
        RowBox[{"-", "4"}], " ", "y"}], ",", "0", ",", "0"}], "}"}]}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7377466532722282`*^9, {3.737746874477056*^9, 3.7377469050808287`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"D", "[", 
  RowBox[{
   RowBox[{"qinv", "[", "qi", "]"}], ",", " ", 
   RowBox[{"{", "qi", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.737747698141684*^9, 3.7377477031454573`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.737747703344623*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["dqij"], "Input",
 CellChangeTimes->{{3.737749457481318*^9, 3.73774945829287*^9}, {
  3.737749504100163*^9, 3.7377495042274303`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", "qyij"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"qxj", " ", "qyi"}], "-", 
       RowBox[{"qxi", " ", "qyj"}], "-", 
       RowBox[{"qwj", " ", "qzi"}], "+", 
       RowBox[{"qwi", " ", "qzj"}]}], ")"}]}], "+", 
    RowBox[{"qzij", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "qwj"}], " ", "qyi"}], "+", 
       RowBox[{"qwi", " ", "qyj"}], "-", 
       RowBox[{"qxj", " ", "qzi"}], "+", 
       RowBox[{"qxi", " ", "qzj"}]}], ")"}]}], "+", 
    RowBox[{"qwij", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "qwj"}], " ", "qxi"}], "+", 
       RowBox[{"qwi", " ", "qxj"}], "+", 
       RowBox[{"qyj", " ", "qzi"}], "-", 
       RowBox[{"qyi", " ", "qzj"}]}], ")"}]}], "-", 
    RowBox[{"qxij", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"qwi", " ", "qwj"}], "+", 
       RowBox[{"qxi", " ", "qxj"}], "+", 
       RowBox[{"qyi", " ", "qyj"}], "+", 
       RowBox[{"qzi", " ", "qzj"}]}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{"qxij", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"qxj", " ", "qyi"}], "-", 
       RowBox[{"qxi", " ", "qyj"}], "-", 
       RowBox[{"qwj", " ", "qzi"}], "+", 
       RowBox[{"qwi", " ", "qzj"}]}], ")"}]}], "+", 
    RowBox[{"qwij", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "qwj"}], " ", "qyi"}], "+", 
       RowBox[{"qwi", " ", "qyj"}], "-", 
       RowBox[{"qxj", " ", "qzi"}], "+", 
       RowBox[{"qxi", " ", "qzj"}]}], ")"}]}], "-", 
    RowBox[{"qzij", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "qwj"}], " ", "qxi"}], "+", 
       RowBox[{"qwi", " ", "qxj"}], "+", 
       RowBox[{"qyj", " ", "qzi"}], "-", 
       RowBox[{"qyi", " ", "qzj"}]}], ")"}]}], "-", 
    RowBox[{"qyij", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"qwi", " ", "qwj"}], "+", 
       RowBox[{"qxi", " ", "qxj"}], "+", 
       RowBox[{"qyi", " ", "qyj"}], "+", 
       RowBox[{"qzi", " ", "qzj"}]}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{"qwij", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"qxj", " ", "qyi"}], "-", 
       RowBox[{"qxi", " ", "qyj"}], "-", 
       RowBox[{"qwj", " ", "qzi"}], "+", 
       RowBox[{"qwi", " ", "qzj"}]}], ")"}]}], "-", 
    RowBox[{"qxij", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "qwj"}], " ", "qyi"}], "+", 
       RowBox[{"qwi", " ", "qyj"}], "-", 
       RowBox[{"qxj", " ", "qzi"}], "+", 
       RowBox[{"qxi", " ", "qzj"}]}], ")"}]}], "+", 
    RowBox[{"qyij", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "qwj"}], " ", "qxi"}], "+", 
       RowBox[{"qwi", " ", "qxj"}], "+", 
       RowBox[{"qyj", " ", "qzi"}], "-", 
       RowBox[{"qyi", " ", "qzj"}]}], ")"}]}], "-", 
    RowBox[{"qzij", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"qwi", " ", "qwj"}], "+", 
       RowBox[{"qxi", " ", "qxj"}], "+", 
       RowBox[{"qyi", " ", "qyj"}], "+", 
       RowBox[{"qzi", " ", "qzj"}]}], ")"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.737749504469*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"dqv", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{"dqx", ",", "dqy", ",", "dqz"}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"D", "[", 
  RowBox[{
   RowBox[{"qxq", "[", 
    RowBox[{
     RowBox[{"qv2q", "[", "dqv", "]"}], ",", " ", "qi"}], "]"}], ",", " ", 
   RowBox[{"{", "dqv", "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Simplify", "[", "%", "]"}], " ", "/.", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"dqx", "\[Rule]", "0"}], ",", " ", 
    RowBox[{"dqy", "\[Rule]", "0"}], ",", " ", 
    RowBox[{"dqz", "\[Rule]", "0"}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.7377494816200953`*^9, 3.737749699483289*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"dqx", ",", "dqy", ",", "dqz"}], "}"}]], "Output",
 CellChangeTimes->{{3.737749486016664*^9, 3.737749543778329*^9}, {
  3.737749578646779*^9, 3.737749598165332*^9}, {3.737749670213992*^9, 
  3.737749699703968*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"qwi", "-", 
      FractionBox[
       RowBox[{"dqx", " ", "qxi"}], 
       SqrtBox[
        RowBox[{"1.`", "\[VeryThinSpace]", "-", 
         SuperscriptBox["dqx", "2"], "-", 
         SuperscriptBox["dqy", "2"], "-", 
         SuperscriptBox["dqz", "2"]}]]]}], ",", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"dqy", " ", "qxi"}], 
        SqrtBox[
         RowBox[{"1.`", "\[VeryThinSpace]", "-", 
          SuperscriptBox["dqx", "2"], "-", 
          SuperscriptBox["dqy", "2"], "-", 
          SuperscriptBox["dqz", "2"]}]]]}], "+", "qzi"}], ",", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"dqz", " ", "qxi"}], 
        SqrtBox[
         RowBox[{"1.`", "\[VeryThinSpace]", "-", 
          SuperscriptBox["dqx", "2"], "-", 
          SuperscriptBox["dqy", "2"], "-", 
          SuperscriptBox["dqz", "2"]}]]]}], "-", "qyi"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"dqx", " ", "qyi"}], 
        SqrtBox[
         RowBox[{"1.`", "\[VeryThinSpace]", "-", 
          SuperscriptBox["dqx", "2"], "-", 
          SuperscriptBox["dqy", "2"], "-", 
          SuperscriptBox["dqz", "2"]}]]]}], "-", "qzi"}], ",", 
     RowBox[{"qwi", "-", 
      FractionBox[
       RowBox[{"dqy", " ", "qyi"}], 
       SqrtBox[
        RowBox[{"1.`", "\[VeryThinSpace]", "-", 
         SuperscriptBox["dqx", "2"], "-", 
         SuperscriptBox["dqy", "2"], "-", 
         SuperscriptBox["dqz", "2"]}]]]}], ",", 
     RowBox[{"qxi", "-", 
      FractionBox[
       RowBox[{"dqz", " ", "qyi"}], 
       SqrtBox[
        RowBox[{"1.`", "\[VeryThinSpace]", "-", 
         SuperscriptBox["dqx", "2"], "-", 
         SuperscriptBox["dqy", "2"], "-", 
         SuperscriptBox["dqz", "2"]}]]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"qyi", "-", 
      FractionBox[
       RowBox[{"dqx", " ", "qzi"}], 
       SqrtBox[
        RowBox[{"1.`", "\[VeryThinSpace]", "-", 
         SuperscriptBox["dqx", "2"], "-", 
         SuperscriptBox["dqy", "2"], "-", 
         SuperscriptBox["dqz", "2"]}]]]}], ",", 
     RowBox[{
      RowBox[{"-", "qxi"}], "-", 
      FractionBox[
       RowBox[{"dqy", " ", "qzi"}], 
       SqrtBox[
        RowBox[{"1.`", "\[VeryThinSpace]", "-", 
         SuperscriptBox["dqx", "2"], "-", 
         SuperscriptBox["dqy", "2"], "-", 
         SuperscriptBox["dqz", "2"]}]]]}], ",", 
     RowBox[{"qwi", "-", 
      FractionBox[
       RowBox[{"dqz", " ", "qzi"}], 
       SqrtBox[
        RowBox[{"1.`", "\[VeryThinSpace]", "-", 
         SuperscriptBox["dqx", "2"], "-", 
         SuperscriptBox["dqy", "2"], "-", 
         SuperscriptBox["dqz", "2"]}]]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"dqx", " ", "qwi"}], 
        SqrtBox[
         RowBox[{"1.`", "\[VeryThinSpace]", "-", 
          SuperscriptBox["dqx", "2"], "-", 
          SuperscriptBox["dqy", "2"], "-", 
          SuperscriptBox["dqz", "2"]}]]]}], "-", "qxi"}], ",", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"dqy", " ", "qwi"}], 
        SqrtBox[
         RowBox[{"1.`", "\[VeryThinSpace]", "-", 
          SuperscriptBox["dqx", "2"], "-", 
          SuperscriptBox["dqy", "2"], "-", 
          SuperscriptBox["dqz", "2"]}]]]}], "-", "qyi"}], ",", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"dqz", " ", "qwi"}], 
        SqrtBox[
         RowBox[{"1.`", "\[VeryThinSpace]", "-", 
          SuperscriptBox["dqx", "2"], "-", 
          SuperscriptBox["dqy", "2"], "-", 
          SuperscriptBox["dqz", "2"]}]]]}], "-", "qzi"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.737749486016664*^9, 3.737749543778329*^9}, {
  3.737749578646779*^9, 3.737749598165332*^9}, {3.737749670213992*^9, 
  3.737749699704962*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0.`", "\[VeryThinSpace]", "+", "qwi"}], ",", 
     RowBox[{"0.`", "\[VeryThinSpace]", "+", "qzi"}], ",", 
     RowBox[{"0.`", "\[VeryThinSpace]", "-", "qyi"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0.`", "\[VeryThinSpace]", "-", "qzi"}], ",", 
     RowBox[{"0.`", "\[VeryThinSpace]", "+", "qwi"}], ",", 
     RowBox[{"0.`", "\[VeryThinSpace]", "+", "qxi"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0.`", "\[VeryThinSpace]", "+", "qyi"}], ",", 
     RowBox[{"0.`", "\[VeryThinSpace]", "-", "qxi"}], ",", 
     RowBox[{"0.`", "\[VeryThinSpace]", "+", "qwi"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0.`", "\[VeryThinSpace]", "-", "qxi"}], ",", 
     RowBox[{"0.`", "\[VeryThinSpace]", "-", "qyi"}], ",", 
     RowBox[{"0.`", "\[VeryThinSpace]", "-", "qzi"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.737749486016664*^9, 3.737749543778329*^9}, {
  3.737749578646779*^9, 3.737749598165332*^9}, {3.737749670213992*^9, 
  3.7377496997063913`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"lqv2q", "[", "dqv", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"lqv2q", "[", "dqv", "]"}], ",", " ", 
    RowBox[{"{", "dqv", "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/.", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"Sin", "[", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["dqx", "2"], "+", 
         SuperscriptBox["dqy", "2"], "+", 
         SuperscriptBox["dqz", "2"]}]], "]"}], 
      RowBox[{
       SuperscriptBox["dqx", "2"], "+", 
       SuperscriptBox["dqy", "2"], "+", 
       SuperscriptBox["dqz", "2"]}]], "\[Rule]", "1"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Sinc", "[", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["dqx", "2"], "+", 
        SuperscriptBox["dqy", "2"], "+", 
        SuperscriptBox["dqz", "2"]}]], "]"}], "\[Rule]", " ", "1"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/.", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"Sin", "[", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["dqx", "2"], "+", 
         SuperscriptBox["dqy", "2"], "+", 
         SuperscriptBox["dqz", "2"]}]], "]"}], 
      RowBox[{
       SuperscriptBox["dqx", "2"], "+", 
       SuperscriptBox["dqy", "2"], "+", 
       SuperscriptBox["dqz", "2"]}]], "\[Rule]", "1"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     SuperscriptBox["dqx", "2"], "+", 
     SuperscriptBox["dqy", "2"], "+", 
     SuperscriptBox["dqz", "2"]}], " ", "\[Rule]", " ", "vn"}], 
   "}"}]}]}], "Input",
 CellChangeTimes->{{3.737749731351915*^9, 3.737749734609902*^9}, {
  3.737749797162834*^9, 3.737749899842079*^9}, {3.737749932025901*^9, 
  3.737750080705428*^9}, {3.73775011101719*^9, 3.737750151000845*^9}, {
  3.737750205850299*^9, 3.737750295544115*^9}, {3.7377503519039183`*^9, 
  3.7377503945431013`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"dqx", " ", 
    RowBox[{"Sinc", "[", 
     SqrtBox[
      RowBox[{
       SuperscriptBox["dqx", "2"], "+", 
       SuperscriptBox["dqy", "2"], "+", 
       SuperscriptBox["dqz", "2"]}]], "]"}]}], ",", 
   RowBox[{"dqy", " ", 
    RowBox[{"Sinc", "[", 
     SqrtBox[
      RowBox[{
       SuperscriptBox["dqx", "2"], "+", 
       SuperscriptBox["dqy", "2"], "+", 
       SuperscriptBox["dqz", "2"]}]], "]"}]}], ",", 
   RowBox[{"dqz", " ", 
    RowBox[{"Sinc", "[", 
     SqrtBox[
      RowBox[{
       SuperscriptBox["dqx", "2"], "+", 
       SuperscriptBox["dqy", "2"], "+", 
       SuperscriptBox["dqz", "2"]}]], "]"}]}], ",", 
   RowBox[{"Cos", "[", 
    SqrtBox[
     RowBox[{
      SuperscriptBox["dqx", "2"], "+", 
      SuperscriptBox["dqy", "2"], "+", 
      SuperscriptBox["dqz", "2"]}]], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.73774973497197*^9, {3.7377498148176126`*^9, 3.737749845380691*^9}, {
   3.73774988465761*^9, 3.737749900133741*^9}, {3.737749936955226*^9, 
   3.737750080958384*^9}, {3.7377501165178213`*^9, 3.73775011889816*^9}, {
   3.73775014894131*^9, 3.7377501513126497`*^9}, {3.737750220053926*^9, 
   3.737750224258717*^9}, {3.737750258762846*^9, 3.737750295889653*^9}, {
   3.737750366158594*^9, 3.737750395027636*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1", "+", 
      FractionBox[
       RowBox[{
        SuperscriptBox["dqx", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          FractionBox[
           RowBox[{"Cos", "[", 
            SqrtBox["vn"], "]"}], 
           SqrtBox["vn"]]}], ")"}]}], 
       SqrtBox["vn"]]}], ",", 
     FractionBox[
      RowBox[{"dqx", " ", "dqy", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         FractionBox[
          RowBox[{"Cos", "[", 
           SqrtBox["vn"], "]"}], 
          SqrtBox["vn"]]}], ")"}]}], 
      SqrtBox["vn"]], ",", 
     FractionBox[
      RowBox[{"dqx", " ", "dqz", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         FractionBox[
          RowBox[{"Cos", "[", 
           SqrtBox["vn"], "]"}], 
          SqrtBox["vn"]]}], ")"}]}], 
      SqrtBox["vn"]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"dqx", " ", "dqy", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         FractionBox[
          RowBox[{"Cos", "[", 
           SqrtBox["vn"], "]"}], 
          SqrtBox["vn"]]}], ")"}]}], 
      SqrtBox["vn"]], ",", 
     RowBox[{"1", "+", 
      FractionBox[
       RowBox[{
        SuperscriptBox["dqy", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          FractionBox[
           RowBox[{"Cos", "[", 
            SqrtBox["vn"], "]"}], 
           SqrtBox["vn"]]}], ")"}]}], 
       SqrtBox["vn"]]}], ",", 
     FractionBox[
      RowBox[{"dqy", " ", "dqz", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         FractionBox[
          RowBox[{"Cos", "[", 
           SqrtBox["vn"], "]"}], 
          SqrtBox["vn"]]}], ")"}]}], 
      SqrtBox["vn"]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"dqx", " ", "dqz", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         FractionBox[
          RowBox[{"Cos", "[", 
           SqrtBox["vn"], "]"}], 
          SqrtBox["vn"]]}], ")"}]}], 
      SqrtBox["vn"]], ",", 
     FractionBox[
      RowBox[{"dqy", " ", "dqz", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         FractionBox[
          RowBox[{"Cos", "[", 
           SqrtBox["vn"], "]"}], 
          SqrtBox["vn"]]}], ")"}]}], 
      SqrtBox["vn"]], ",", 
     RowBox[{"1", "+", 
      FractionBox[
       RowBox[{
        SuperscriptBox["dqz", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          FractionBox[
           RowBox[{"Cos", "[", 
            SqrtBox["vn"], "]"}], 
           SqrtBox["vn"]]}], ")"}]}], 
       SqrtBox["vn"]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"dqx", " ", 
        RowBox[{"Sin", "[", 
         SqrtBox["vn"], "]"}]}], 
       SqrtBox["vn"]]}], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"dqy", " ", 
        RowBox[{"Sin", "[", 
         SqrtBox["vn"], "]"}]}], 
       SqrtBox["vn"]]}], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"dqz", " ", 
        RowBox[{"Sin", "[", 
         SqrtBox["vn"], "]"}]}], 
       SqrtBox["vn"]]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.73774973497197*^9, {3.7377498148176126`*^9, 3.737749845380691*^9}, {
   3.73774988465761*^9, 3.737749900133741*^9}, {3.737749936955226*^9, 
   3.737750080958384*^9}, {3.7377501165178213`*^9, 3.73775011889816*^9}, {
   3.73775014894131*^9, 3.7377501513126497`*^9}, {3.737750220053926*^9, 
   3.737750224258717*^9}, {3.737750258762846*^9, 3.737750295889653*^9}, {
   3.737750366158594*^9, 3.737750395029634*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"N", "[", 
  RowBox[{"Sinc", "[", "5", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"N", "[", 
  RowBox[{
   RowBox[{"Sin", "[", "5", "]"}], "/", "5"}], "]"}]}], "Input",
 CellChangeTimes->{{3.737749757907887*^9, 3.737749785546068*^9}}],

Cell[BoxData[
 RowBox[{"-", "0.1917848549326277`"}]], "Output",
 CellChangeTimes->{{3.737749765823122*^9, 3.73774978584429*^9}}],

Cell[BoxData[
 RowBox[{"-", "0.1917848549326277`"}]], "Output",
 CellChangeTimes->{{3.737749765823122*^9, 3.737749785845417*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Limit", "[", " ", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     FractionBox[
      RowBox[{"Cos", "[", "x", "]"}], "x"]}], "x"], ",", " ", 
   RowBox[{"x", "\[Rule]", "0.000000000000001"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Limit", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Sin", "[", "x", "]"}], "/", "x"}], ",", " ", 
   RowBox[{"x", "\[Rule]", "0"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7377503969892883`*^9, 3.737750457005157*^9}, {
  3.737750545054941*^9, 3.7377505486583643`*^9}}],

Cell[BoxData["9.999999999999989`*^29"], "Output",
 CellChangeTimes->{
  3.737750409088847*^9, {3.737750444905422*^9, 3.737750457356594*^9}, 
   3.73775054889354*^9}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{
  3.737750409088847*^9, {3.737750444905422*^9, 3.737750457356594*^9}, 
   3.737750548893993*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"D", "[", " ", 
  RowBox[{
   RowBox[{"Sqrt", "[", 
    RowBox[{
     SuperscriptBox["x", "2"], "+", 
     SuperscriptBox["y", "2"], "+", 
     SuperscriptBox["z", "2"]}], "]"}], ",", " ", 
   RowBox[{"{", "x", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7377510853672657`*^9, 3.737751131225623*^9}}],

Cell[BoxData[
 FractionBox["x", 
  SqrtBox[
   RowBox[{
    SuperscriptBox["x", "2"], "+", 
    SuperscriptBox["y", "2"], "+", 
    SuperscriptBox["z", "2"]}]]]], "Output",
 CellChangeTimes->{3.7377511340143137`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"D", "[", " ", 
  RowBox[{
   RowBox[{"Sqrt", "[", 
    RowBox[{
     SuperscriptBox["x", "2"], "+", 
     SuperscriptBox["y", "2"], "+", 
     SuperscriptBox["z", "2"]}], "]"}], ",", " ", 
   RowBox[{"{", "y", "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"D", "[", " ", 
  RowBox[{
   RowBox[{"Sqrt", "[", 
    RowBox[{
     SuperscriptBox["x", "2"], "+", 
     SuperscriptBox["y", "2"], "+", 
     SuperscriptBox["z", "2"]}], "]"}], ",", " ", 
   RowBox[{"{", "z", "}"}]}], "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.737751124946773*^9, 3.737751128241946*^9}}],

Cell[BoxData[
 FractionBox["y", 
  SqrtBox[
   RowBox[{
    SuperscriptBox["x", "2"], "+", 
    SuperscriptBox["y", "2"], "+", 
    SuperscriptBox["z", "2"]}]]]], "Output",
 CellChangeTimes->{{3.737751105863402*^9, 3.737751128456023*^9}}],

Cell[BoxData[
 FractionBox["z", 
  SqrtBox[
   RowBox[{
    SuperscriptBox["x", "2"], "+", 
    SuperscriptBox["y", "2"], "+", 
    SuperscriptBox["z", "2"]}]]]], "Output",
 CellChangeTimes->{{3.737751105863402*^9, 3.737751128458477*^9}}]
}, Open  ]]
},
WindowSize->{928, 1028},
WindowMargins->{{-10, Automatic}, {Automatic, -10}},
FrontEndVersion->"10.3 for Linux x86 (64-bit) (December 10, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 12823, 341, 1256, "Input"],
Cell[13384, 363, 5558, 137, 780, "Input"],
Cell[18945, 502, 1078, 32, 165, "Input"],
Cell[CellGroupData[{
Cell[20048, 538, 1229, 35, 77, "Input"],
Cell[21280, 575, 10854, 331, 452, "Output"],
Cell[32137, 908, 3415, 101, 143, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35589, 1014, 3514, 96, 451, "Input"],
Cell[39106, 1112, 2848, 82, 143, "Output"],
Cell[41957, 1196, 338, 7, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[42332, 1208, 706, 19, 77, "Input"],
Cell[43041, 1229, 1070, 25, 55, "Output"],
Cell[44114, 1256, 1070, 25, 55, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45221, 1286, 4931, 109, 847, "Input"],
Cell[50155, 1397, 20095, 530, 1033, "Output"],
Cell[70253, 1929, 2102, 44, 121, "Output"],
Cell[72358, 1975, 914, 14, 32, "Output"],
Cell[73275, 1991, 8356, 209, 89, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[81668, 2205, 1170, 31, 218, "Input"],
Cell[82841, 2238, 1079, 31, 61, "Output"],
Cell[83923, 2271, 5607, 172, 343, "Output"],
Cell[89533, 2445, 2466, 82, 158, "Output"],
Cell[92002, 2529, 1901, 55, 158, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[93940, 2589, 825, 22, 77, "Input"],
Cell[94768, 2613, 623, 19, 32, "Output"],
Cell[95394, 2634, 586, 18, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[96017, 2657, 173, 4, 32, "Input"],
Cell[96193, 2663, 1722, 50, 99, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[97952, 2718, 1068, 32, 143, "Input"],
Cell[99023, 2752, 3520, 104, 187, "Output"],
Cell[102546, 2858, 621, 19, 32, "Output"],
Cell[103170, 2879, 230, 6, 32, "Output"],
Cell[103403, 2887, 924, 28, 55, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[104364, 2920, 413, 10, 77, "Input"],
Cell[104780, 2932, 644, 18, 32, "Output"],
Cell[105427, 2952, 873, 25, 55, "Output"],
Cell[106303, 2979, 873, 25, 55, "Output"]
}, Open  ]],
Cell[107191, 3007, 96, 1, 32, "Input"],
Cell[CellGroupData[{
Cell[107312, 3012, 1075, 30, 99, "Input"],
Cell[108390, 3044, 617, 18, 32, "Output"],
Cell[109010, 3064, 588, 18, 32, "Output"],
Cell[109601, 3084, 618, 18, 32, "Output"],
Cell[110222, 3104, 586, 18, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[110845, 3127, 543, 14, 55, "Input"],
Cell[111391, 3143, 2203, 71, 77, "Output"],
Cell[113597, 3216, 2145, 71, 77, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[115779, 3292, 208, 5, 32, "Input"],
Cell[115990, 3299, 474, 14, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[116501, 3318, 146, 2, 32, "Input"],
Cell[116650, 3322, 3167, 97, 143, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[119854, 3424, 663, 17, 77, "Input"],
Cell[120520, 3443, 253, 5, 32, "Output"],
Cell[120776, 3450, 3956, 117, 337, "Output"],
Cell[124735, 3569, 1098, 26, 55, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[125870, 3600, 2035, 62, 277, "Input"],
Cell[127908, 3664, 1311, 36, 86, "Output"],
Cell[129222, 3702, 3833, 131, 276, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[133092, 3838, 262, 6, 55, "Input"],
Cell[133357, 3846, 128, 2, 32, "Output"],
Cell[133488, 3850, 129, 2, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[133654, 3857, 560, 16, 95, "Input"],
Cell[134217, 3875, 165, 3, 34, "Output"],
Cell[134385, 3880, 145, 3, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[134567, 3888, 327, 9, 37, "Input"],
Cell[134897, 3899, 216, 7, 59, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[135150, 3911, 610, 17, 84, "Input"],
Cell[135763, 3930, 238, 7, 59, "Output"],
Cell[136004, 3939, 238, 7, 59, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
